{
    "version": 3,
    "file": "factory.js",
    "sourceRoot": "",
    "sources": [
        "/src/factory.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport qs from 'qs';\nimport {RendererStore, IRendererStore, IIRendererStore} from './store/index';\nimport {getEnv} from 'mobx-state-tree';\nimport {Location, parsePath} from 'history';\nimport {wrapFetcher} from './utils/api';\nimport {\n  createObject,\n  extendObject,\n  guid,\n  findIndex,\n  promisify,\n  anyChanged,\n  syncDataFromSuper,\n  isObjectShallowModified,\n  isVisible,\n  isEmpty,\n  autobind\n} from './utils/helper';\nimport {\n  Api,\n  fetcherResult,\n  Payload,\n  SchemaNode,\n  Schema,\n  Action,\n  ExtractProps,\n  Omit,\n  PlainObject,\n  RendererData\n} from './types';\nimport {observer} from 'mobx-react';\nimport getExprProperties from './utils/filter-schema';\nimport hoistNonReactStatic = require('hoist-non-react-statics');\nimport omit = require('lodash/omit');\nimport difference = require('lodash/difference');\nimport isPlainObject = require('lodash/isPlainObject');\nimport Scoped from './Scoped';\nimport {getTheme, ThemeInstance, ClassNamesFn, ThemeContext} from './theme';\nimport find = require('lodash/find');\nimport Alert from './components/Alert2';\nimport {LazyComponent} from './components';\n\nexport interface TestFunc {\n  (\n    path: string,\n    schema?: Schema,\n    resolveRenderer?: (\n      path: string,\n      schema?: Schema,\n      props?: any\n    ) => null | RendererConfig\n  ): boolean;\n}\n\nexport interface RendererBasicConfig {\n  test: RegExp | TestFunc;\n  name?: string;\n  storeType?: string;\n  storeExtendsData?: boolean; // 是否需要继承上层数据。\n  weight?: number; // 权重，值越低越优先命中。\n  isolateScope?: boolean;\n  isFormItem?: boolean;\n  // [propName:string]:any;\n}\n\nexport interface RendererEnv {\n  fetcher: (api: Api, data?: any, options?: object) => Promise<Payload>;\n  isCancel: (val: any) => boolean;\n  notify: (type: 'error' | 'success', msg: string) => void;\n  jumpTo: (to: string, action?: Action, ctx?: object) => void;\n  alert: (msg: string) => void;\n  confirm: (msg: string, title?: string) => Promise<boolean>;\n  updateLocation: (location: any, replace?: boolean) => void;\n  isCurrentUrl: (link: string) => boolean;\n  rendererResolver?: (\n    path: string,\n    schema: Schema,\n    props: any\n  ) => null | RendererConfig;\n  copy?: (contents: string) => void;\n  getModalContainer?: () => HTMLElement;\n  theme: ThemeInstance;\n  affixOffsetTop: number;\n  affixOffsetBottom: number;\n  richTextToken: string;\n  loadRenderer: (\n    schema: Schema,\n    path: string,\n    reRender: Function\n  ) => Promise<React.ReactType> | React.ReactType | JSX.Element | void;\n  [propName: string]: any;\n}\n\nexport interface RendererProps {\n  render: (region: string, node: SchemaNode, props?: any) => JSX.Element;\n  env: RendererEnv;\n  classPrefix: string;\n  classnames: ClassNamesFn;\n  $path: string; // 当前组件所在的层级信息\n  store?: IIRendererStore;\n  data: {\n    [propName: string]: any;\n  };\n  defaultData?: object;\n  className?: string;\n  [propName: string]: any;\n}\n\nexport interface renderChildProps extends Partial<RendererProps> {\n  env: RendererEnv;\n}\n\nexport type RendererComponent = React.ComponentType<RendererProps> & {\n  propsList?: Array<string>;\n};\n\nexport interface RendererConfig extends RendererBasicConfig {\n  component: RendererComponent;\n  Renderer?: RendererComponent; // 原始组件\n}\n\nexport interface RenderSchemaFilter {\n  (schema: Schema, renderer: RendererConfig, props?: object): SchemaNode;\n}\n\nexport interface RootRenderProps {\n  location?: Location;\n  theme?: string;\n  [propName: string]: any;\n}\n\nexport interface RenderOptions {\n  session?: string;\n  fetcher?: (config: fetcherConfig) => Promise<fetcherResult>;\n  isCancel?: (value: any) => boolean;\n  notify?: (type: 'error' | 'success', msg: string) => void;\n  jumpTo?: (to: string) => void;\n  alert?: (msg: string) => void;\n  confirm?: (msg: string, title?: string) => boolean | Promise<boolean>;\n  rendererResolver?: (\n    path: string,\n    schema: Schema,\n    props: any\n  ) => null | RendererConfig;\n  copy?: (contents: string) => void;\n  getModalContainer?: () => HTMLElement;\n  loadRenderer?: (\n    schema: Schema,\n    path: string,\n    reRender: Function\n  ) => Promise<React.ReactType> | React.ReactType | JSX.Element | void;\n  affixOffsetTop?: number;\n  affixOffsetBottom?: number;\n  richTextToken?: string;\n  [propName: string]: any;\n}\n\nexport interface fetcherConfig {\n  url: string;\n  method: 'get' | 'post' | 'put' | 'patch' | 'delete';\n  data?: any;\n  config?: any;\n}\n\nexport type ReactElement = React.ReactNode[] | JSX.Element | null | false;\n\nconst renderers: Array<RendererConfig> = [];\nconst rendererNames: Array<string> = [];\nconst schemaFilters: Array<RenderSchemaFilter> = [];\nlet anonymousIndex = 1;\n\nexport function addSchemaFilter(fn: RenderSchemaFilter) {\n  schemaFilters.push(fn);\n}\n\nexport function filterSchema(\n  schema: Schema,\n  render: RendererConfig,\n  props?: any\n) {\n  return schemaFilters.reduce(\n    (schema, filter) => filter(schema, render, props),\n    schema\n  ) as Schema;\n}\n\nexport function Renderer(config: RendererBasicConfig) {\n  return function<T extends RendererComponent>(component: T): T {\n    const renderer = registerRenderer({\n      ...config,\n      component: component\n    });\n    return renderer.component as T;\n  };\n}\n\nexport function registerRenderer(config: RendererConfig): RendererConfig {\n  if (!config.test) {\n    throw new TypeError('config.test is required');\n  } else if (!config.component) {\n    throw new TypeError('config.component is required');\n  }\n\n  config.weight = config.weight || 0;\n  config.Renderer = config.component;\n  config.name = config.name || `anonymous-${anonymousIndex++}`;\n\n  if (~rendererNames.indexOf(config.name)) {\n    throw new Error(\n      `The renderer with name \"${\n        config.name\n      }\" has already exists, please try another name!`\n    );\n  }\n\n  if (config.storeType && config.component) {\n    config.component = HocStoreFactory({\n      storeType: config.storeType,\n      extendsData: config.storeExtendsData\n    })(observer(config.component));\n  }\n\n  if (config.isolateScope) {\n    config.component = Scoped(config.component);\n  }\n\n  const idx = findIndex(\n    renderers,\n    item => (config.weight as number) < item.weight\n  );\n  ~idx ? renderers.splice(idx, 0, config) : renderers.push(config);\n  rendererNames.push(config.name);\n  return config;\n}\n\nexport function unRegisterRenderer(config: RendererConfig | string) {\n  let idx =\n    typeof config === 'string'\n      ? findIndex(renderers, item => item.name === config)\n      : renderers.indexOf(config);\n  ~idx && renderers.splice(idx, 1);\n\n  // 清空渲染器定位缓存\n  cache = {};\n}\n\nexport function renderChildren(\n  prefix: string,\n  node: SchemaNode,\n  props: renderChildProps\n): ReactElement {\n  if (Array.isArray(node)) {\n    return node.map((node, index) =>\n      renderChild(`${prefix}/${index}`, node, {\n        ...props,\n        key: `${props.key ? `${props.key}-` : ''}${index}`\n      })\n    );\n  }\n\n  return renderChild(prefix, node, props);\n}\n\nexport function renderChild(\n  prefix: string,\n  node: SchemaNode,\n  props: renderChildProps\n): ReactElement {\n  if (Array.isArray(node)) {\n    return renderChildren(prefix, node, props);\n  }\n\n  const typeofnode = typeof node;\n  let schema: Schema =\n    typeofnode === 'string' || typeofnode === 'number'\n      ? {type: 'tpl', tpl: String(node)}\n      : (node as Schema);\n  const detectData =\n    schema.detectField === '&' ? props : props[schema.detectField || 'data'];\n  const exprProps = detectData ? getExprProperties(schema, detectData) : null;\n\n  if (\n    exprProps &&\n    (exprProps.hidden ||\n      exprProps.visible === false ||\n      schema.hidden ||\n      schema.visible === false ||\n      props.hidden ||\n      props.visible === false)\n  ) {\n    return null;\n  }\n\n  const transform = props.propsTransform;\n\n  if (transform) {\n    delete props.propsTransform;\n    props = transform(props);\n  }\n\n  return (\n    <SchemaRenderer\n      {...props}\n      {...exprProps}\n      schema={schema}\n      $path={`${prefix ? `${prefix}/` : ''}${(schema && schema.type) || ''}`}\n    />\n  );\n}\n\nexport interface RootRendererProps {\n  schema: SchemaNode;\n  rootStore: IRendererStore;\n  env: RendererEnv;\n  theme: string;\n  pathPrefix?: string;\n  [propName: string]: any;\n}\n\nconst RootStoreContext = React.createContext<IRendererStore>(undefined as any);\n\nexport class RootRenderer extends React.Component<RootRendererProps> {\n  state = {\n    error: null,\n    errorInfo: null\n  };\n\n  componentDidCatch(error: any, errorInfo: any) {\n    console.error(error);\n    this.setState({\n      error: error,\n      errorInfo: errorInfo\n    });\n  }\n\n  @autobind\n  resolveDefinitions(name: string) {\n    const definitions = (this.props.schema as Schema).definitions;\n    if (!name || isEmpty(definitions)) {\n      return {};\n    }\n    return definitions && definitions[name];\n  }\n\n  render() {\n    const {error, errorInfo} = this.state;\n    if (errorInfo) {\n      return errorRenderer(error, errorInfo);\n    }\n    const {\n      schema,\n      rootStore,\n      env,\n      pathPrefix,\n      location,\n      data,\n      ...rest\n    } = this.props;\n\n    const theme = env.theme;\n    const query =\n      (location && location.query) ||\n      (location && location.search && qs.parse(location.search.substring(1))) ||\n      (window.location.search && qs.parse(window.location.search.substring(1)));\n\n    const finalData = query\n      ? createObject(\n          {\n            ...(data && data.__super ? data.__super : null),\n            ...query,\n            query\n          },\n          data\n        )\n      : data;\n\n    return (\n      <RootStoreContext.Provider value={rootStore}>\n        <ThemeContext.Provider value={this.props.theme || 'default'}>\n          {\n            renderChild(\n              pathPrefix || '',\n              isPlainObject(schema)\n                ? {\n                    type: 'page',\n                    ...(schema as Schema)\n                  }\n                : schema,\n              {\n                ...rest,\n                resolveDefinitions: this.resolveDefinitions,\n                location: location,\n                data: finalData,\n                env,\n                classnames: theme.classnames,\n                classPrefix: theme.classPrefix\n              }\n            ) as JSX.Element\n          }\n        </ThemeContext.Provider>\n      </RootStoreContext.Provider>\n    );\n  }\n}\n\nexport const ScopedRootRenderer = Scoped(RootRenderer);\n\ninterface SchemaRendererProps extends Partial<RendererProps> {\n  schema: Schema;\n  $path: string;\n  env: RendererEnv;\n}\n\nconst defaultOmitList = [\n  'type',\n  'name',\n  '$ref',\n  'className',\n  'data',\n  'children',\n  'ref',\n  'visible',\n  'visibleOn',\n  'hidden',\n  'hiddenOn',\n  'disabled',\n  'disabledOn',\n  'component',\n  'detectField'\n];\n\nclass SchemaRenderer extends React.Component<SchemaRendererProps, any> {\n  static displayName: string = 'Renderer';\n\n  renderer: RendererConfig | null;\n  ref: any;\n\n  constructor(props: SchemaRendererProps) {\n    super(props);\n    this.refFn = this.refFn.bind(this);\n    this.renderChild = this.renderChild.bind(this);\n    this.reRender = this.reRender.bind(this);\n  }\n\n  componentWillMount() {\n    this.resolveRenderer(this.props);\n  }\n\n  componentWillReceiveProps(nextProps: SchemaRendererProps) {\n    const props = this.props;\n\n    if (\n      props.schema.type !== nextProps.schema.type ||\n      props.schema.$$id !== nextProps.schema.$$id\n    ) {\n      this.resolveRenderer(nextProps);\n    }\n  }\n\n  // 限制：只有 schema 除外的 props 变化，或者 schema 里面的某个成员值发生变化才更新。\n  shouldComponentUpdate(nextProps: SchemaRendererProps) {\n    const props = this.props;\n    const list: Array<string> = difference(Object.keys(nextProps), ['schema']);\n\n    if (\n      difference(Object.keys(props), ['schema']).length !== list.length ||\n      anyChanged(list, this.props, nextProps)\n    ) {\n      return true;\n    } else {\n      const list: Array<string> = Object.keys(nextProps.schema);\n\n      if (\n        Object.keys(props.schema).length !== list.length ||\n        anyChanged(list, props.schema, nextProps.schema)\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  resolveRenderer(props: SchemaRendererProps): any {\n    let schema = props.schema;\n    let path = props.$path;\n    const rendererResolver = props.env.rendererResolver || resolveRenderer;\n    if (schema.$ref) {\n      schema = {\n        ...props.resolveDefinitions(schema.$ref),\n        ...schema\n      };\n      delete schema.$ref;\n      path = path.replace(/(?!.*\\/).*/, schema.type);\n    }\n    // value 会提前从 control 中获取到，所有需要把control中的属性也补充完整\n    // if (schema.control && schema.control.$ref) {\n    //     schema.control = {\n    //         ...props.resolveDefinitions(schema.control.$ref),\n    //         ...schema.control\n    //     }\n    //     delete schema.control.$ref;\n    // }\n    this.renderer = rendererResolver(path, schema, props);\n    return schema;\n  }\n\n  getWrappedInstance() {\n    return this.ref;\n  }\n\n  refFn(ref: any) {\n    this.ref = ref;\n  }\n\n  renderChild(\n    region: string,\n    node?: SchemaNode,\n    subProps: {\n      data?: object;\n      [propName: string]: any;\n    } = {}\n  ) {\n    let {schema, $path, env, ...rest} = this.props;\n\n    const omitList = defaultOmitList.concat();\n    if (this.renderer) {\n      const Component = this.renderer.component;\n      Component.propsList &&\n        omitList.push.apply(omitList, Component.propsList as Array<string>);\n    }\n\n    return renderChild(`${$path}${region ? `/${region}` : ''}`, node || '', {\n      ...omit(rest, omitList),\n      ...subProps,\n      data: subProps.data || rest.data,\n      env: env\n    });\n  }\n\n  reRender() {\n    this.resolveRenderer(this.props);\n    this.forceUpdate();\n  }\n\n  render(): JSX.Element | null {\n    let {$path, schema, ...rest} = this.props;\n\n    if (schema.$ref) {\n      schema = this.resolveRenderer(this.props);\n    }\n\n    const theme = this.props.env.theme;\n\n    if (Array.isArray(schema)) {\n      return renderChildren($path, schema, rest) as JSX.Element;\n    } else if (schema.children) {\n      return React.isValidElement(schema.children)\n        ? schema.children\n        : (schema.children as Function)({\n            ...rest,\n            $path: $path,\n            render: this.renderChild\n          });\n    } else if (typeof schema.component === 'function') {\n      return React.createElement(schema.component as any, {\n        ...rest,\n        $path: $path,\n        render: this.renderChild\n      });\n    } else if (!this.renderer) {\n      return (\n        <LazyComponent\n          {...rest}\n          getComponent={async () => {\n            const result = await rest.env.loadRenderer(\n              schema,\n              $path,\n              this.reRender\n            );\n            if (result && typeof result === 'function') {\n              return result;\n            } else if (result && React.isValidElement(result)) {\n              return () => result;\n            }\n\n            this.reRender();\n            return () => loadRenderer(schema, $path);\n          }}\n          $path={$path}\n          retry={this.reRender}\n        />\n      );\n    }\n\n    const renderer = this.renderer as RendererConfig;\n    schema = filterSchema(schema, renderer, rest);\n    const {data: defaultData, ...restSchema} = schema;\n    const Component = renderer.component;\n\n    return (\n      <Component\n        {...theme.getRendererConfig(renderer.name)}\n        {...restSchema}\n        {...rest}\n        defaultData={defaultData}\n        $path={$path}\n        ref={this.refFn}\n        render={this.renderChild}\n      />\n    );\n  }\n}\n\nexport function HocStoreFactory(renderer: {\n  storeType: string;\n  extendsData?: boolean;\n}): any {\n  return function<T extends React.ComponentType<RendererProps>>(Component: T) {\n    type Props = Omit<\n      RendererProps,\n      'store' | 'data' | 'dataUpdatedAt' | 'scope'\n    > & {\n      store?: IIRendererStore;\n      data?: RendererData;\n      scope?: RendererData;\n    };\n\n    @observer\n    class StoreFactory extends React.Component<Props> {\n      static displayName = `WithStore(${Component.displayName ||\n        Component.name})`;\n      static ComposedComponent = Component;\n      static contextType = RootStoreContext;\n      store: IIRendererStore;\n      context!: React.ContextType<typeof RootStoreContext>;\n      ref: any;\n\n      getWrappedInstance() {\n        return this.ref;\n      }\n\n      refFn(ref: any) {\n        this.ref = ref;\n      }\n\n      formatData(data: any): object {\n        if (Array.isArray(data)) {\n          return {\n            items: data\n          };\n        }\n\n        return data as object;\n      }\n\n      componentWillMount() {\n        const rootStore = this.context;\n        this.renderChild = this.renderChild.bind(this);\n        this.refFn = this.refFn.bind(this);\n\n        const store = (this.store = rootStore.addStore({\n          id: guid(),\n          path: this.props.$path,\n          storeType: renderer.storeType,\n          parentId: this.props.store ? this.props.store.id : ''\n        } as any));\n\n        if (renderer.extendsData === false) {\n          store.initData(\n            createObject(\n              (this.props.data as any)\n                ? (this.props.data as any).__super\n                : null,\n              {\n                ...this.formatData(this.props.defaultData),\n                ...this.formatData(this.props.data)\n              }\n            )\n          );\n        } else if (\n          this.props.scope ||\n          (this.props.data && (this.props.data as any).__super)\n        ) {\n          if (this.props.store && this.props.data === this.props.store.data) {\n            store.initData(\n              createObject(this.props.store.data, {\n                ...this.formatData(this.props.defaultData)\n              })\n            );\n          } else {\n            store.initData(\n              createObject(\n                (this.props.data as any).__super || this.props.scope,\n                {\n                  ...this.formatData(this.props.defaultData),\n                  ...this.formatData(this.props.data)\n                }\n              )\n            );\n          }\n        } else {\n          store.initData({\n            ...this.formatData(this.props.defaultData),\n            ...this.formatData(this.props.data)\n          });\n        }\n      }\n\n      componentWillReceiveProps(nextProps: RendererProps) {\n        const props = this.props;\n        const store = this.store;\n\n        if (renderer.extendsData === false) {\n          (props.defaultData !== nextProps.defaultData ||\n            isObjectShallowModified(props.data, nextProps.data) ||\n            // CRUD 中 toolbar 里面的 data 是空对象，但是 __super 会不一样\n            (nextProps.data &&\n              props.data &&\n              nextProps.data.__super !== props.data.__super)) &&\n            store.initData(\n              extendObject(nextProps.data, {\n                ...(store.hasRemoteData ? store.data : null), // todo 只保留 remote 数据\n                ...this.formatData(nextProps.defaultData),\n                ...this.formatData(nextProps.data)\n              })\n            );\n        } else if (isObjectShallowModified(props.data, nextProps.data)) {\n          if (nextProps.store && nextProps.store.data === nextProps.data) {\n            const newData = createObject(\n              nextProps.store.data,\n              syncDataFromSuper(\n                store.data,\n                nextProps.store.data,\n                props.scope,\n                nextProps.dataUpdatedAt !== props.dataUpdatedAt,\n                store\n              )\n            );\n\n            // todo fix: dialog 种数据从孩子 form 同步过来后，会走这个逻辑让 form 更新 data，会导致里面的 __prev 丢失。\n            store.initData(newData);\n          } else if (nextProps.data && (nextProps.data as any).__super) {\n            store.initData(extendObject(nextProps.data));\n          } else {\n            store.initData(createObject(nextProps.scope, nextProps.data));\n          }\n        } else if (\n          (!nextProps.store || nextProps.data !== nextProps.store.data) &&\n          nextProps.data &&\n          nextProps.data.__super\n        ) {\n          // 这个用法很少，当 data.__super 值发生变化时，更新 store.data\n          (!props.data ||\n            isObjectShallowModified(\n              nextProps.data.__super,\n              props.data.__super,\n              false\n            )) &&\n            store.initData(\n              createObject(nextProps.data.__super, {\n                ...nextProps.data,\n                ...store.data\n              })\n            );\n        } else if (props.scope !== nextProps.scope) {\n          store.initData(\n            createObject(nextProps.scope, {\n              // ...nextProps.data,\n              ...store.data\n            })\n          );\n        }\n      }\n\n      componentWillUnmount() {\n        const rootStore = this.context as IRendererStore;\n        const store = this.store;\n        rootStore.removeStore(store);\n        delete this.store;\n      }\n\n      renderChild(\n        region: string,\n        node: SchemaNode,\n        subProps: {\n          data?: object;\n          [propName: string]: any;\n        } = {}\n      ) {\n        let {render} = this.props;\n\n        return render(region, node, {\n          data: this.store.data,\n          dataUpdatedAt: this.store.updatedAt,\n          ...subProps,\n          scope: this.store.data,\n          store: this.store\n        });\n      }\n\n      render() {\n        const {detectField, ...rest} = this.props;\n\n        let exprProps: any = {};\n        if (!detectField || detectField === 'data') {\n          exprProps = getExprProperties(rest, this.store.data);\n\n          if (exprProps.hidden || exprProps.visible === false) {\n            return null;\n          }\n        }\n\n        return (\n          <Component\n            {\n              ...rest as any /* todo */\n            }\n            {...exprProps}\n            ref={this.refFn}\n            data={this.store.data}\n            dataUpdatedAt={this.store.updatedAt}\n            store={this.store}\n            scope={this.store.data}\n            render={this.renderChild}\n          />\n        );\n      }\n    }\n    hoistNonReactStatic(StoreFactory, Component);\n\n    return StoreFactory;\n  };\n}\n\nfunction loadRenderer(schema: Schema, path: string) {\n  return (\n    <Alert level=\"danger\">\n      <p>Error: 找不到对应的渲染器</p>\n      <p>Path: {path}</p>\n      <pre>\n        <code>{JSON.stringify(schema, null, 2)}</code>\n      </pre>\n    </Alert>\n  );\n}\n\nfunction errorRenderer(error: any, errorInfo: any) {\n  return (\n    <Alert level=\"danger\">\n      <p>{error && error.toString()}</p>\n      <pre>\n        <code>{errorInfo.componentStack}</code>\n      </pre>\n    </Alert>\n  );\n}\n\nconst defaultOptions: RenderOptions = {\n  session: 'global',\n  affixOffsetTop: 50,\n  affixOffsetBottom: 0,\n  richTextToken: '',\n  loadRenderer,\n  fetcher() {\n    return Promise.reject('fetcher is required');\n  },\n  isCancel() {\n    console.error(\n      'Please implements this. see https://baidu.github.io/amis/docs/getting-started#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8'\n    );\n    return false;\n  },\n  alert(msg: string) {\n    alert(msg);\n  },\n  updateLocation() {\n    console.error(\n      'Please implements this. see https://baidu.github.io/amis/docs/getting-started#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8'\n    );\n  },\n  confirm(msg: string) {\n    return confirm(msg);\n  },\n  notify(msg) {\n    alert(msg);\n  },\n  jumpTo() {\n    console.error(\n      'Please implements this. see https://baidu.github.io/amis/docs/getting-started#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8'\n    );\n  },\n  isCurrentUrl() {\n    return false;\n  },\n  copy(contents: string) {\n    console.error('copy contents', contents);\n  },\n  rendererResolver: resolveRenderer\n};\nlet stores: {\n  [propName: string]: IRendererStore;\n} = {};\nexport function render(\n  schema: SchemaNode,\n  props: RootRenderProps = {},\n  options: RenderOptions = {},\n  pathPrefix: string = ''\n): JSX.Element {\n  options = {\n    ...defaultOptions,\n    ...options\n  };\n\n  let store =\n    stores[options.session || 'global'] ||\n    (stores[options.session || 'global'] = RendererStore.create(\n      {},\n      {\n        ...options,\n        fetcher: options.fetcher\n          ? wrapFetcher(options.fetcher)\n          : defaultOptions.fetcher,\n        confirm: options.confirm\n          ? promisify(options.confirm)\n          : defaultOptions.confirm\n      }\n    ));\n\n  (window as any).amisStore = store; // 为了方便 debug.\n  const env = getEnv(store);\n  const theme = props.theme || options.theme || 'default';\n  env.theme = getTheme(theme);\n\n  return (\n    <ScopedRootRenderer\n      {...props}\n      schema={schema}\n      pathPrefix={pathPrefix}\n      rootStore={store}\n      env={env}\n      theme={theme}\n    />\n  );\n}\n\nexport function clearStoresCache(sessions?: Array<string>) {\n  if (Array.isArray(sessions) && sessions.length) {\n    sessions.forEach(key => delete stores[key]);\n  } else {\n    stores = {};\n  }\n}\n\nlet cache: {[propName: string]: RendererConfig} = {};\nexport function resolveRenderer(\n  path: string,\n  schema?: Schema,\n  props?: any\n): null | RendererConfig {\n  if (cache[path]) {\n    return cache[path];\n  } else if (path && path.length > 1024) {\n    throw new Error('Path太长是不是死循环了？');\n  }\n\n  let renderer: null | RendererConfig = null;\n\n  renderers.some(item => {\n    let matched = false;\n\n    if (typeof item.test === 'function') {\n      matched = item.test(path, schema, resolveRenderer);\n    } else if (item.test instanceof RegExp) {\n      matched = item.test.test(path);\n    }\n\n    if (matched) {\n      renderer = item;\n    }\n\n    return matched;\n  });\n\n  // 只能缓存纯正则表达式的后者方法中没有用到第二个参数的，因为自定义 test 函数的有可能依赖 schema 的结果\n  if (\n    renderer !== null &&\n    ((renderer as RendererConfig).test instanceof RegExp ||\n      (typeof (renderer as RendererConfig).test === 'function' &&\n        ((renderer as RendererConfig).test as Function).length < 2))\n  ) {\n    cache[path] = renderer;\n  }\n\n  return renderer;\n}\n\nexport function getRenderers() {\n  return renderers.concat();\n}\n\nexport function getRendererByName(name: string) {\n  return find(renderers, item => item.name === name);\n}\n"
    ]
}