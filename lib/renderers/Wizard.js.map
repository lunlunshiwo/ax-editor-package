{
    "version": 3,
    "file": "Wizard.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Wizard.tsx"
    ],
    "names": [],
    "mappings": ";;;AAAA,wDAA0B;AAC1B,oCAAgE;AAChE,sCAAmD;AACnD,4CAA6D;AAE7D,oCAAoD;AACpD,+BAAkC;AAElC,0CAA+D;AAC/D,oCAA2D;AAE3D,4CAAsC;AAkBtC;IAAoC,kCAAyC;IA2B3E,gBAAY,KAAkB;QAA9B,YACE,kBAAM,KAAK,CAAC,SAcb;QAZC,KAAI,CAAC,KAAK,GAAG;YACX,WAAW,EAAE,CAAC,CAAC,CAAC,gBAAgB;SACjC,CAAC;QAEF,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/D,KAAI,CAAC,iBAAiB,GAAG,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC3D,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACvC,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrC,KAAI,CAAC,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;IACjE,CAAC;IAED,kCAAiB,GAAjB;QAAA,iBAoEC;QAnEO,IAAA,eASQ,EARZ,oBAAO,EACP,wBAAS,EACT,8BAAY,EACZ,wCAAiB,EACjB,gBAAK,EACL,cAAI,EACJ,gBAAqC,EAA1B,8BAAY,EAAE,4BAAW,EACpC,kBACY,CAAC;QAEf,IAAI,oBAAc,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE;YAClD,KAAK;iBACF,aAAa,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;gBAClC,cAAc,EAAE,YAAY;gBAC5B,YAAY,EAAE,WAAW;gBACzB,SAAS,EAAE;oBACT,IACE,CAAC,oBAAc,CAAC,YAAY,EAAE,KAAK,CAAC,IAAI,CAAC;wBACzC,KAAK,CAAC,IAAI,CAAC,iBAAiB,IAAI,UAAU,CAAC,EAC3C;wBACA,OAAO;qBACR;oBAED,OAAO,cAAK,CACV,cAAM,OAAA,KAAK,CAAC,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC,IAAI,CAAC,EAA3C,CAA2C,EACjD,UAAC,GAAQ,IAAK,OAAA,GAAG,IAAI,GAAG,CAAC,iBAAiB,IAAI,UAAU,CAAC,EAA3C,CAA2C,EACzD,UAAA,MAAM,IAAI,OAAA,CAAC,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC,EAA3B,CAA2B,CACtC,CAAC;gBACJ,CAAC;aACF,CAAC;iBACD,IAAI,CAAC,UAAA,KAAK;gBACT,MAAM,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAC7B,IAAM,KAAK,GAAG;oBACZ,WAAW,EAAE,CAAC;iBACf,CAAC;gBAEF,IACE,KAAK;oBACL,KAAK,CAAC,IAAI;oBACV,CAAC,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,QAAQ;wBAClC,CAAC,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,QAAQ;4BAClC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EACnC;oBACA,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;iBACnD;gBAED,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;oBACnB,iCAAiC;oBACjC,IACE,KAAK;wBACL,KAAK,CAAC,IAAI;wBACV,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,EAC7C;wBACA,KAAI,CAAC,WAAW,EAAE,CAAC;qBACpB;gBACH,CAAC,CAAC,CAAC;gBACH,OAAO,KAAK,CAAC;YACf,CAAC,CAAC,CAAC;SACN;aAAM;YACL,IAAI,CAAC,QAAQ,CACX;gBACE,WAAW,EAAE,CAAC;aACf,EACD,cAAM,OAAA,MAAM,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAA5B,CAA4B,CACnC,CAAC;SACH;IACH,CAAC;IAED,mCAAkB,GAAlB,UAAmB,SAAsB;QACvC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QAClB,IAAA,mBAAK,EAAE,iCAAY,EAAE,+BAAW,CAAU;QAEjD,IACE,mBAAa,CACX,SAAS,CAAC,OAAO,EACjB,KAAK,CAAC,OAAO,EACb,SAAS,CAAC,IAAI,EACd,KAAK,CAAC,IAAI,CACX,EACD;YACA,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE;gBACzC,cAAc,EAAE,YAAY;gBAC5B,YAAY,EAAE,WAAW;aAC1B,CAAC,CAAC;SACJ;IACH,CAAC;IAED,qCAAoB,GAApB;QACE,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;IACzC,CAAC;IAED,yBAAQ,GAAR,UAAS,KAAa;QACpB,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,CAAC;QACrC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;QAEnD,IAAI,CAAC,QAAQ,CAAC;YACZ,WAAW,EAAE,KAAK;SACnB,CAAC,CAAC;IACL,CAAC;IAED,wBAAO,GAAP,UAAQ,GAAQ;QACd,IAAI,GAAG,EAAE;YACP,OAAO,GAAG,IAAI,GAAG,CAAC,kBAAkB,EAAE;gBACpC,GAAG,GAAG,GAAG,CAAC,kBAAkB,EAAE,CAAC;aAChC;YACD,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;SACjB;aAAM;YACL,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC;SACvB;IACH,CAAC;IAED,+BAAc,GAAd,UAAe,MAAc,EAAE,MAAc;QAC3C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAED,6BAAY,GAAZ,UAAa,MAAc,EAAE,IAAS;QACpC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAED,uBAAM,GAAN,UAAO,GAAQ;QACb,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;IACjB,CAAC;IAED,oCAAmB,GAAnB;QACE,OAAO,IAAI,CAAC,GAAG,CAAC;IAClB,CAAC;IAED,cAAc;IACd,4BAAW,GAAX;;QAAA,iBAwCC;QAvCO,IAAA,eAUQ,EATZ,gBAAK,EACL,gBAAK,EACL,sBAAQ,EACR,gCAAa,EACb,kBAAM,EACN,sBAAQ,EACR,kBAAM,EACN,YAAG,EACH,0BACY,CAAC;QAEf,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;QAC/C,IAAI,cAAc,GAChB,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,CAAC;YACvB,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,KAAK,KAAK,CAAC,MAAM,IAAI,QAAQ,CAAC,CAAC;QAExD,IAAI,CAAC,IAAI,IAAI,CAAC,oBAAc,CAAC,cAAc,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE;YACxD,OAAO;SACR;QAED,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACvB,KAAK,CAAC,UAAU;YACd,GAAC,aAAa,IAAI,UAAU,IAAG,KAAK;gBACpC,CAAC;QAEH,cAAK,CACH,cAAM,OAAA,KAAK,CAAC,WAAW,CAAC,cAAqB,EAAE,KAAK,CAAC,IAAI,CAAC,EAApD,CAAoD,EAC1D,UAAC,GAAQ,IAAK,OAAA,GAAG,IAAI,GAAG,CAAC,aAAa,IAAI,UAAU,CAAC,EAAvC,CAAuC,EACrD,UAAA,MAAM,IAAI,OAAA,CAAC,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC,EAA3B,CAA2B,CACtC;aACE,IAAI,CAAC;YACJ,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YACxB,KAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;QAC5C,CAAC,CAAC;aACD,KAAK,CAAC,UAAA,CAAC;YACN,GAAG,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC;YAC/B,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IAED,6BAAY,GAAZ,UACE,CAA4B,EAC5B,MAAc,EACd,IAAY,EACZ,WAAqB;QAJvB,iBAmDC;QA7CO,IAAA,eAAmC,EAAlC,sBAAQ,EAAE,gBAAK,EAAE,YAAiB,CAAC;QAE1C,IAAI,MAAM,CAAC,UAAU,KAAK,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,QAAQ,EAAE;YAC5D,IAAI,CAAC,IAAI,CAAC,QAAQ,uCAEX,MAAM,KACT,UAAU,EAAE,QAAQ,KAEtB,IAAI,CACL,CAAC;SACH;aAAM,IAAI,MAAM,CAAC,UAAU,KAAK,MAAM,EAAE;YACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;SAC3C;aAAM,IAAI,MAAM,CAAC,IAAI,KAAK,OAAO,EAAE;YAClC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;SACnB;aAAM,IAAI,MAAM,CAAC,UAAU,KAAK,QAAQ,EAAE;YACzC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;SACxB;aAAM,IAAI,MAAM,CAAC,UAAU,KAAK,MAAM,EAAE;YACvC,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE;gBACf,OAAO,GAAG,CAAC,KAAK,CAAC,+EAAkC,CAAC,CAAC;aACtD;YAED,OAAO,KAAK;iBACT,UAAU,CAAC,MAAM,CAAC,GAAU,EAAE,IAAI,EAAE;gBACnC,cAAc,EAAE,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,OAAO;gBAC1D,YAAY,EAAE,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM;aACxD,CAAC;iBACD,IAAI,CAAC,UAAM,QAAQ;;;;4BAClB,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;iCAE7D,CAAA,MAAM,CAAC,QAAQ,IAAI,kBAAS,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,CAAA,EAAzD,wBAAyD;4BAC3D,qBAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,EAAA;;4BAApD,SAAoD,CAAC;;;4BAGvD,MAAM,CAAC,MAAM;gCACX,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC;gCAC9C,CAAC,CAAC,MAAM,CAAC,QAAQ;oCACjB,CAAC,CAAC,GAAG,CAAC,cAAc,CAAC,YAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;oCACzD,CAAC,CAAC,IAAI,CAAC;;;;iBACV,CAAC;iBACD,KAAK,CAAC,cAAO,CAAC,CAAC,CAAC;SACpB;aAAM,IAAI,MAAM,CAAC,UAAU,KAAK,QAAQ,EAAE;YACzC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;SACzD;aAAM,IAAI,QAAQ,EAAE;YACnB,QAAQ,CAAC,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;SAC3B;IACH,CAAC;IAED,6BAAY,GAAZ,UAAa,MAAW,EAAE,GAAQ;QAAlC,iBAYC;QAXC,OAAO,IAAI,OAAO,CAAC,UAAA,OAAO;YACjB,IAAA,yBAAK,CAAe;YAC3B,KAAK,CAAC,gBAAgB,CAAC;gBACrB,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE,QAAQ;gBACpB,MAAM,EAAE,MAAM;aACf,CAAC,CAAC;YACH,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE,SAAS,EAAE,UAAA,SAAS;gBACxC,OAAO,CAAC,SAAS,CAAC,CAAC;YACrB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,6BAAY,GAAZ,UAAa,MAAc;QAClB,IAAA,wBAAK,CAAe;QAE3B,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;IAC3B,CAAC;IAED,kDAAkD;IAClD,6BAAY,GAAZ,UAAa,MAAc,EAAE,MAAc;;QAA3C,iBA0HC;QAzHO,IAAA,eAWQ,EAVZ,gBAAK,EACL,gBAAK,EACL,YAAG,EACH,sBAAQ,EACR,gCAAa,EACb,kBAAM,EACN,sBAAQ,EACR,kBAAM,EACN,YAAG,EACH,0BACY,CAAC;QAEf,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;QAC/C,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAEzB,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,MAAM,EAAE;YACzC,IAAI,gBAAc,GAAG,MAAM,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC;YAEtD,oBAAc,CAAC,gBAAc,EAAE,KAAK,CAAC,IAAI,CAAC;gBACxC,KAAK,CAAC,UAAU;oBACd,GAAC,aAAa,IAAI,UAAU,IAAG,KAAK;wBACpC,CAAC;YAEL,IAAI,oBAAc,CAAC,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE;gBACtD,KAAK;qBACF,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,EAAE;oBAC9C,SAAS,EAAE;wBACT,IACE,CAAC,oBAAc,CAAC,gBAAc,EAAE,KAAK,CAAC,IAAI,CAAC;4BAC3C,KAAK,CAAC,IAAI,CAAC,aAAa,IAAI,UAAU,CAAC,EACvC;4BACA,OAAO;yBACR;wBAED,OAAO,cAAK,CACV,cAAM,OAAA,KAAK,CAAC,WAAW,CAAC,gBAAqB,EAAE,KAAK,CAAC,IAAI,CAAC,EAApD,CAAoD,EAC1D,UAAC,GAAQ,IAAK,OAAA,GAAG,IAAI,GAAG,CAAC,aAAa,IAAI,UAAU,CAAC,EAAvC,CAAuC,EACrD,UAAA,MAAM,IAAI,OAAA,CAAC,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC,EAA3B,CAA2B,CACtC,CAAC;oBACJ,CAAC;iBACF,CAAC;qBACD,IAAI,CAAC,UAAC,KAAU;oBACf,OAAA,KAAI,CAAC,QAAQ,CACX,KAAK,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ;wBACrC,CAAC,CAAC,KAAK,CAAC,IAAI;wBACZ,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAC/B;gBAJD,CAIC,CACF;qBACA,KAAK,CAAC,UAAA,CAAC;oBACN,aAAa;gBACf,CAAC,CAAC,CAAC;aACN;iBAAM;gBACL,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;aAC3C;SACF;aAAM;YACL,OAAO;YACP,IAAI,MAAM,EAAE;gBACV,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;aACzC;iBAAM,IAAI,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,GAAG,EAAE;gBACxC,IAAI,gBAAc,GAAG,MAAM,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC;gBAElE,oBAAc,CAAC,gBAAc,EAAE,KAAK,CAAC,IAAI,CAAC;oBACxC,KAAK,CAAC,UAAU;wBACd,GAAC,aAAa,IAAI,UAAU,IAAG,KAAK;4BACpC,CAAC;gBAEL,IAAM,SAAS,GAAG,IAAI,CAAC,IAAI;oBACzB,CAAC,CAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAoB;oBACvC,CAAC,CAAC,KAAK,CAAC;gBACV,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBAEvB,SAAS;qBACN,UAAU,CAAC,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,GAAG,EAAE,KAAK,CAAC,IAAI,EAAE;oBACrD,SAAS,EAAE;wBACT,IACE,CAAC,oBAAc,CAAC,gBAAc,EAAE,KAAK,CAAC,IAAI,CAAC;4BAC3C,KAAK,CAAC,IAAI,CAAC,aAAa,IAAI,UAAU,CAAC,EACvC;4BACA,OAAO;yBACR;wBAED,OAAO,cAAK,CACV,cAAM,OAAA,KAAK,CAAC,WAAW,CAAC,gBAAqB,EAAE,KAAK,CAAC,IAAI,CAAC,EAApD,CAAoD,EAC1D,UAAC,GAAQ,IAAK,OAAA,GAAG,IAAI,GAAG,CAAC,aAAa,IAAI,UAAU,CAAC,EAAvC,CAAuC,EACrD,UAAA,MAAM,IAAI,OAAA,CAAC,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC,EAA3B,CAA2B,CACtC,CAAC;oBACJ,CAAC;iBACF,CAAC;qBACD,IAAI,CAAC,UAAA,KAAK;oBACT,KAAK,CAAC,UAAU,uCACX,KAAK,CAAC,IAAI,GACV,KAAK,EACR,CAAC;oBACH,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;oBAExB,IAAI,KAAK,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ,EAAE;wBAC3C,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;qBAC3B;yBAAM,IAAI,UAAU,IAAI,UAAU,CAAC,KAAK,EAAE,MAAM,CAAC,KAAK,KAAK,EAAE;wBAC5D,sBAAsB;wBACtB,OAAO,KAAK,CAAC;qBACd;oBAED,IAAI,QAAQ,EAAE;wBACZ,GAAG,CAAC,cAAc,CAAC,YAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;qBAClD;yBAAM,IAAI,MAAM,EAAE;wBACjB,KAAI,CAAC,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;qBACvC;oBAED,OAAO,KAAK,CAAC;gBACf,CAAC,CAAC;qBACD,KAAK,CAAC,UAAA,CAAC;oBACN,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;oBACxB,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnB,CAAC,CAAC,CAAC;aACN;iBAAM;gBACL,UAAU,IAAI,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;aAC9C;SACF;QAED,OAAO,KAAK,CAAC;IACf,CAAC;IAED,oCAAmB,GAAnB,UACE,MAAgB,EAChB,MAAc,EACd,GAAQ,EACR,OAAmB;QAEZ,IAAA,wBAAK,CAAe;QAE3B,IACE,MAAM,CAAC,SAAS;YAChB,MAAM,CAAC,MAAM,KAAK,CAAC;YACnB,MAAM,CAAC,CAAC,CAAC;YACT,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,KAAK,MAAM,EAChC;YACA,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;SAC7B;QAED,KAAK,CAAC,WAAW,EAAE,CAAC;IACtB,CAAC;IAED,kCAAiB,GAAjB;QACS,IAAA,wBAAK,CAAe;QAC3B,KAAK,CAAC,WAAW,EAAE,CAAC;IACtB,CAAC;IAED,4BAAW,GAAX;QAAA,iBAyCC;QAxCO,IAAA,eAAkD,EAAjD,gBAAK,EAAE,gBAAK,EAAE,cAAI,EAAE,mBAA6B,CAAC;QACzD,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;QAE3C,OAAO,CACL,uCACE,SAAS,EAAK,EAAE,qBAAgB,EAAE,gBAAW,IAAM,EACnD,EAAE,EAAC,aAAa,IAEf,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CACtC,0CACG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI,EAAE,GAAG;YACnB,IAAM,OAAO,GAAG,UAAU,CAAC,IAAI,EAAE,GAAG,EAAE,WAAW,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;YAE/D,OAAO,CACL,sCACE,GAAG,EAAE,GAAG,EACR,SAAS,EAAE,EAAE,CAAC;oBACZ,aAAa,EAAE,OAAO;oBACtB,WAAW,EAAE,WAAW,KAAK,GAAG,GAAG,CAAC;iBACrC,CAAC,EACF,OAAO,EAAE,cAAM,OAAA,CAAC,OAAO,CAAC,CAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAzC,CAAyC;gBAExD,wCACE,SAAS,EAAE,EAAE,CAAC,OAAO,EAAE;wBACrB,uDAAuD;wBACvD,WAAW,EACT,WAAW,KAAK,GAAG,GAAG,CAAC;4BACvB,CAAC,OAAO,IAAI,WAAW,IAAI,GAAG,GAAG,CAAC,CAAC;qBACtC,CAAC,IAED,GAAG,GAAG,CAAC,CACH;gBACN,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,IAAI,aAAK,GAAG,GAAG,CAAC,aAAI,CAC1C,CACN,CAAC;QACJ,CAAC,CAAC,CACC,CACN,CAAC,CAAC,CAAC,IAAI,CACJ,CACP,CAAC;IACJ,CAAC;IAED,8BAAa,GAAb;QAAA,iBA4FC;QA3FO,IAAA,eAaQ,EAZZ,gBAAK,EACL,gBAAK,EACL,sBAAQ,EACR,sBAAQ,EACR,oCAAe,EACf,oCAAe,EACf,oCAAe,EACf,4CAAmB,EACnB,wCAAiB,EACjB,kBAAM,EACN,mBAAe,EACf,kBACY,CAAC;QAEf,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YACzB,OAAO,IAAI,CAAC;SACb;QAED,IAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;QAChD,IAAM,QAAQ,GAAG,KAAK,CAAC,gBAAgB,CAAC,CAAC;QACzC,IAAM,QAAQ,GAAG,KAAK,CAAC,gBAAgB,GAAG,CAAC,CAAC,CAAC;QAC7C,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;QAC9B,IAAM,IAAI,GAAG,KAAK,CAAC,gBAAgB,GAAG,CAAC,CAAC,CAAC;QAEzC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,IAAI,CAAC;SACb;QAED,IAAM,WAAW,GAAG,QAAQ;YAC1B,CAAC,CAAC,UAAU,CAAC,QAAQ,EAAE,gBAAgB,GAAG,CAAC,EAAE,gBAAgB,EAAE,KAAK,CAAC,IAAI,CAAC;YAC1E,CAAC,CAAC,KAAK,CAAC;QAEV,IAAI,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;YAC/C,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAC3B,uCAAK,SAAS,EAAE,EAAE,CAAC,cAAc,CAAC,IAC/B,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAC,MAAc,EAAE,KAAa;gBAC9C,OAAA,MAAM,CAAC,YAAU,KAAO,EAAE,MAAM,EAAE;oBAChC,GAAG,EAAE,KAAK;oBACV,QAAQ,EAAE,KAAI,CAAC,YAAY;oBAC3B,QAAQ,EACN,MAAM,CAAC,QAAQ;wBACf,OAAO;wBACP,QAAQ;wBACR,CAAC,MAAM,CAAC,UAAU,KAAK,MAAM,IAAI,CAAC,WAAW,CAAC;wBAC9C,CAAC,MAAM,CAAC,UAAU,KAAK,MAAM;4BAC3B,QAAQ;4BACR,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;iBAC/B,CAAC;YAXF,CAWE,CACH,CACG,CACP,CAAC,CAAC,CAAC,IAAI,CAAC;SACV;QAED,OAAO,CACL,uCAAK,SAAS,EAAE,EAAE,CAAC,cAAc,CAAC;YAC/B,MAAM,CACL,UAAU,EACV;gBACE,IAAI,EAAE,QAAQ;gBACd,KAAK,EAAE,eAAe;gBACtB,UAAU,EAAE,MAAM;gBAClB,SAAS,EAAE,eAAe;aAC3B,EACD;gBACE,QAAQ,EAAE,OAAO,IAAI,CAAC,WAAW,IAAI,QAAQ;gBAC7C,QAAQ,EAAE,IAAI,CAAC,YAAY;aAC5B,CACF;YAEA,MAAM,CACL,UAAU,EACV;gBACE,IAAI,EAAE,QAAQ;gBACd,KAAK,EAAE,CAAC,QAAQ;oBACd,CAAC,CAAC,iBAAiB;oBACnB,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG;wBACX,CAAC,CAAC,eAAe;wBACjB,CAAC,CAAC,mBAAmB;gBACvB,UAAU,EAAE,MAAM;gBAClB,OAAO,EAAE,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG;gBAChC,SAAS,EAAE,eAAe;aAC3B,EACD;gBACE,QAAQ,EACN,OAAO,IAAI,QAAQ,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAChE,QAAQ,EAAE,IAAI,CAAC,YAAY;aAC5B,CACF,CACG,CACP,CAAC;IACJ,CAAC;IAED,uBAAM,GAAN;QACQ,IAAA,eAAqE,EAApE,wBAAS,EAAE,gBAAK,EAAE,kBAAM,EAAE,gBAAK,EAAE,cAAI,EAAE,mBAA6B,CAAC;QAE5E,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;QAC3C,IAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAElE,OAAO,CACL,uCACE,GAAG,EAAE,IAAI,CAAC,MAAM,EAChB,SAAS,EAAE,EAAE,CAAI,EAAE,cAAS,EAAE,uBAAkB,EAAE,WAAQ,EAAE,SAAS,CAAC;YAErE,IAAI,CAAC,WAAW,EAAE;YACnB,uCAAK,SAAS,EAAK,EAAE,gCAA6B,IAC/C,IAAI,CAAC,CAAC,CAAC,CACN,MAAM,CACJ,MAAM,wCAED,IAAI,KACP,IAAI,EAAE,MAAM,EACZ,aAAa,EAAE,KAAK;gBAEpB,cAAc;gBACd,GAAG,EAAE,IAAI,KAEX;gBACE,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW;gBAC3B,GAAG,EAAE,IAAI,CAAC,OAAO;gBACjB,QAAQ,EAAE,IAAI,CAAC,YAAY;gBAC3B,QAAQ,EAAE,IAAI,CAAC,YAAY;gBAC3B,QAAQ,EAAE,KAAK,CAAC,OAAO;gBACvB,gBAAgB,EAAE,IAAI,CAAC,mBAAmB;gBAC1C,QAAQ,EAAE,IAAI,CAAC,YAAY;aAC5B,CACF,CACF,CAAC,CAAC,CAAC,WAAW,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CACvB,OAAO,CACR,CAAC,CAAC,CAAC,CACF,qCAAG,SAAS,EAAC,aAAa,+BAAS,CACpC,CACG;YAEL,MAAM,CACL,QAAQ,wCAEH,CAAE,KAAK,CAAC,MAAiB;gBACxB,KAAK,CAAC,MAAiB,CAAC,MAAiB,CAAC,KAC9C,IAAI,EAAE,QAAQ,KAEhB;gBACE,GAAG,EAAE,QAAQ;gBACb,IAAI,EAAE,KAAK,CAAC,UAAU;gBACtB,SAAS,EAAE,IAAI,CAAC,mBAAmB;gBACnC,OAAO,EAAE,IAAI,CAAC,iBAAiB;gBAC/B,IAAI,EAAE,KAAK,CAAC,UAAU;aACvB,CACF;YACA,IAAI,CAAC,aAAa,EAAE;YAErB,8BAAC,oBAAO,IAAC,IAAI,EAAC,IAAI,EAAC,OAAO,QAAC,GAAG,EAAC,MAAM,EAAC,IAAI,EAAE,KAAK,CAAC,OAAO,GAAI,CACzD,CACP,CAAC;IACJ,CAAC;IA5nBM,mBAAY,GAAyB;QAC1C,IAAI,EAAE,YAAY;QAClB,QAAQ,EAAE,KAAK;QACf,QAAQ,EAAE,EAAE;QACZ,eAAe,EAAE,EAAE;QACnB,eAAe,EAAE,KAAK;QACtB,eAAe,EAAE,KAAK;QACtB,mBAAmB,EAAE,QAAQ;QAC7B,iBAAiB,EAAE,IAAI;KACxB,CAAC;IAEK,gBAAS,GAAkB;QAChC,OAAO;QACP,MAAM;QACN,UAAU;QACV,iBAAiB;QACjB,iBAAiB;QACjB,iBAAiB;QACjB,qBAAqB;QACrB,mBAAmB;QACnB,YAAY;KACb,CAAC;IAwmBJ,aAAC;CAAA,AA9nBD,CAAoC,eAAK,CAAC,SAAS,GA8nBlD;kBA9nBoB,MAAM;AAgoB3B,SAAS,UAAU,CAAC,IAAS,EAAE,KAAa,EAAE,WAAmB,EAAE,IAAS;IAC1E,IAAI,OAAO,GAAG,KAAK,CAAC;IAEpB,IAAI,IAAI,IAAI,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE;QAC3C,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC;KACzB;SAAM,IAAI,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;QAClC,OAAO,GAAG,oBAAc,CACtB,IAAI,CAAC,UAAU,EACf,qBAAY,CAAC,IAAI,EAAE;YACjB,WAAW,aAAA;SACZ,CAAC,CACH,CAAC;KACH;SAAM;QACL,OAAO,GAAG,KAAK,GAAG,CAAC,GAAG,WAAW,CAAC;KACnC;IAED,OAAO,OAAO,CAAC;AACjB,CAAC;AAQD;IAAoC,0CAAM;IAA1C;;IA2CA,CAAC;IAxCC,2CAAkB,GAAlB;QACE,IAAM,MAAM,GAAG,IAAI,CAAC,OAAyB,CAAC;QAC9C,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;IACjC,CAAC;IAED,6CAAoB,GAApB;QACE,IAAM,MAAM,GAAG,IAAI,CAAC,OAAyB,CAAC;QAC9C,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;IACnC,CAAC;IAED,iCAAQ,GAAR,UAAS,MAAc,EAAE,IAAY,EAAE,WAA4B;QAA5B,4BAAA,EAAA,mBAA4B;QACjE,OAAO,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;IACjE,CAAC;IAED,uCAAc,GAAd,UAAe,MAAc,EAAE,MAAc;QAC3C,IAAM,MAAM,GAAG,IAAI,CAAC,OAAyB,CAAC;QAC9C,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC9B,CAAC;IAED,qCAAY,GAAZ,UAAa,MAAc,EAAE,IAAS;QACpC,IAAM,MAAM,GAAG,IAAI,CAAC,OAAyB,CAAC;QAC9C,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED,4CAAmB,GAAnB,UACE,MAAgB,EAChB,MAAc,EACd,GAAQ,EACR,OAAmB;QAEnB,iBAAM,mBAAmB,YAAC,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;QAExD,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QAC/B,IAAM,MAAM,GAAG,IAAI,CAAC,OAAyB,CAAC;QAC9C,IAAI,MAAM,CAAC,MAAM,EAAE;YACjB,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;SAC1C;aAAM,IAAI,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE;YAC9C,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;SAChD;IACH,CAAC;IAzCM,0BAAW,GAAG,sBAAa,CAAC;IADxB,cAAc;QAN1B,kBAAQ,CAAC;YACR,IAAI,EAAE,eAAe;YACrB,SAAS,EAAE,sBAAY,CAAC,IAAI;YAC5B,IAAI,EAAE,QAAQ;YACd,YAAY,EAAE,IAAI;SACnB,CAAC;OACW,cAAc,CA2C1B;IAAD,qBAAC;CAAA,AA3CD,CAAoC,MAAM,GA2CzC;AA3CY,wCAAc",
    "sourcesContent": [
        "import React from 'react';\nimport Scoped, {ScopedContext, IScopedContext} from '../Scoped';\nimport {Renderer, RendererProps} from '../factory';\nimport {ServiceStore, IServiceStore} from '../store/service';\nimport {Api, SchemaNode, Schema, Action} from '../types';\nimport {filter, evalExpression} from '../utils/tpl';\nimport cx = require('classnames');\nimport {observer} from 'mobx-react';\nimport {createObject, until, isVisible} from '../utils/helper';\nimport {isApiOutdated, isEffectiveApi} from '../utils/api';\nimport {IFormStore} from '../store/form';\nimport {Spinner} from '../components';\n\nexport interface WizardProps extends RendererProps {\n  store: IServiceStore;\n  readOnly?: boolean;\n  actionClassName?: string;\n  actionPrevLabel?: string;\n  actionNextLabel?: string;\n  actionNextSaveLabel?: string;\n  actionFinishLabel?: string;\n  mode?: 'horizontal' | 'vertical';\n  onFinished: (values: object, action: any) => any;\n}\n\nexport interface WizardState {\n  currentStep: number;\n}\n\nexport default class Wizard extends React.Component<WizardProps, WizardState> {\n  static defaultProps: Partial<WizardProps> = {\n    mode: 'horizontal', // vertical\n    readOnly: false,\n    messages: {},\n    actionClassName: '',\n    actionPrevLabel: '上一步',\n    actionNextLabel: '下一步',\n    actionNextSaveLabel: '保存并下一步',\n    actionFinishLabel: '完成'\n  };\n\n  static propsList: Array<string> = [\n    'steps',\n    'mode',\n    'messages',\n    'actionClassName',\n    'actionPrevLabel',\n    'actionNextLabel',\n    'actionNextSaveLabel',\n    'actionFinishLabel',\n    'onFinished'\n  ];\n\n  dom: any;\n  form: any;\n  asyncCancel: () => void;\n  constructor(props: WizardProps) {\n    super(props);\n\n    this.state = {\n      currentStep: -1 // init 完后会设置成 1\n    };\n\n    this.handleAction = this.handleAction.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleDialogConfirm = this.handleDialogConfirm.bind(this);\n    this.handleDialogClose = this.handleDialogClose.bind(this);\n    this.formRef = this.formRef.bind(this);\n    this.domRef = this.domRef.bind(this);\n    this.getPopOverContainer = this.getPopOverContainer.bind(this);\n  }\n\n  componentDidMount() {\n    const {\n      initApi,\n      initFetch,\n      initAsyncApi,\n      initFinishedField,\n      store,\n      data,\n      messages: {fetchSuccess, fetchFailed},\n      onInit\n    } = this.props;\n\n    if (isEffectiveApi(initApi, store.data, initFetch)) {\n      store\n        .fetchInitData(initApi, store.data, {\n          successMessage: fetchSuccess,\n          errorMessage: fetchFailed,\n          onSuccess: () => {\n            if (\n              !isEffectiveApi(initAsyncApi, store.data) ||\n              store.data[initFinishedField || 'finished']\n            ) {\n              return;\n            }\n\n            return until(\n              () => store.checkRemote(initAsyncApi, store.data),\n              (ret: any) => ret && ret[initFinishedField || 'finished'],\n              cancel => (this.asyncCancel = cancel)\n            );\n          }\n        })\n        .then(value => {\n          onInit && onInit(store.data);\n          const state = {\n            currentStep: 1\n          };\n\n          if (\n            value &&\n            value.data &&\n            (typeof value.data.step === 'number' ||\n              (typeof value.data.step === 'string' &&\n                /^\\d+$/.test(value.data.step)))\n          ) {\n            state.currentStep = parseInt(value.data.step, 10);\n          }\n\n          this.setState(state, () => {\n            // 如果 initApi 返回的状态是正在提交，则进入轮顺状态。\n            if (\n              value &&\n              value.data &&\n              (value.data.submiting || value.data.submited)\n            ) {\n              this.checkSubmit();\n            }\n          });\n          return value;\n        });\n    } else {\n      this.setState(\n        {\n          currentStep: 1\n        },\n        () => onInit && onInit(store.data)\n      );\n    }\n  }\n\n  componentDidUpdate(prevProps: WizardProps) {\n    const props = this.props;\n    const {store, fetchSuccess, fetchFailed} = props;\n\n    if (\n      isApiOutdated(\n        prevProps.initApi,\n        props.initApi,\n        prevProps.data,\n        props.data\n      )\n    ) {\n      store.fetchData(props.initApi, store.data, {\n        successMessage: fetchSuccess,\n        errorMessage: fetchFailed\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.asyncCancel && this.asyncCancel();\n  }\n\n  gotoStep(index: number) {\n    const steps = this.props.steps || [];\n    index = Math.max(Math.min(steps.length, index), 1);\n\n    this.setState({\n      currentStep: index\n    });\n  }\n\n  formRef(ref: any) {\n    if (ref) {\n      while (ref && ref.getWrappedInstance) {\n        ref = ref.getWrappedInstance();\n      }\n      this.form = ref;\n    } else {\n      this.form = undefined;\n    }\n  }\n\n  submitToTarget(target: string, values: object) {\n    throw new Error('Please implements this!');\n  }\n\n  reloadTarget(target: string, data: any) {\n    throw new Error('Please implements this!');\n  }\n\n  domRef(ref: any) {\n    this.dom = ref;\n  }\n\n  getPopOverContainer() {\n    return this.dom;\n  }\n\n  // 用来还原异步提交状态。\n  checkSubmit() {\n    const {\n      store,\n      steps,\n      asyncApi,\n      finishedField,\n      target,\n      redirect,\n      reload,\n      env,\n      onFinished\n    } = this.props;\n\n    const step = steps[this.state.currentStep - 1];\n    let finnalAsyncApi =\n      (step && step.asyncApi) ||\n      (this.state.currentStep === steps.length && asyncApi);\n\n    if (!step || !isEffectiveApi(finnalAsyncApi, store.data)) {\n      return;\n    }\n\n    store.markSaving(true);\n    store.updateData({\n      [finishedField || 'finished']: false\n    });\n\n    until(\n      () => store.checkRemote(finnalAsyncApi as Api, store.data),\n      (ret: any) => ret && ret[finishedField || 'finished'],\n      cancel => (this.asyncCancel = cancel)\n    )\n      .then(() => {\n        store.markSaving(false);\n        this.gotoStep(this.state.currentStep + 1);\n      })\n      .catch(e => {\n        env.notify('error', e.message);\n        store.markSaving(false);\n      });\n  }\n\n  handleAction(\n    e: React.UIEvent<any> | void,\n    action: Action,\n    data: object,\n    throwErrors?: boolean\n  ) {\n    const {onAction, store, env} = this.props;\n\n    if (action.actionType === 'next' || action.type === 'submit') {\n      this.form.doAction(\n        {\n          ...action,\n          actionType: 'submit'\n        },\n        data\n      );\n    } else if (action.actionType === 'prev') {\n      this.gotoStep(this.state.currentStep - 1);\n    } else if (action.type === 'reset') {\n      this.form.reset();\n    } else if (action.actionType === 'dialog') {\n      store.openDialog(data);\n    } else if (action.actionType === 'ajax') {\n      if (!action.api) {\n        return env.alert(`当 actionType 为 ajax 时，请设置 api 属性`);\n      }\n\n      return store\n        .saveRemote(action.api as Api, data, {\n          successMessage: action.messages && action.messages.success,\n          errorMessage: action.messages && action.messages.failed\n        })\n        .then(async response => {\n          this.form && this.form.isValidated() && this.form.validate(true);\n\n          if (action.feedback && isVisible(action.feedback, store.data)) {\n            await this.openFeedback(action.feedback, store.data);\n          }\n\n          action.reload\n            ? this.reloadTarget(action.reload, store.data)\n            : action.redirect\n            ? env.updateLocation(filter(action.redirect, store.data))\n            : null;\n        })\n        .catch(() => {});\n    } else if (action.actionType === 'reload') {\n      action.target && this.reloadTarget(action.target, data);\n    } else if (onAction) {\n      onAction(e, action, data);\n    }\n  }\n\n  openFeedback(dialog: any, ctx: any) {\n    return new Promise(resolve => {\n      const {store} = this.props;\n      store.setCurrentAction({\n        type: 'button',\n        actionType: 'dialog',\n        dialog: dialog\n      });\n      store.openDialog(ctx, undefined, confirmed => {\n        resolve(confirmed);\n      });\n    });\n  }\n\n  handleChange(values: object) {\n    const {store} = this.props;\n\n    store.updateData(values);\n  }\n\n  // 接管里面 form 的提交，不能直接让 form 提交，因为 wizard 自己需要知道进度。\n  handleSubmit(values: object, action: Action) {\n    const {\n      store,\n      steps,\n      api,\n      asyncApi,\n      finishedField,\n      target,\n      redirect,\n      reload,\n      env,\n      onFinished\n    } = this.props;\n\n    const step = steps[this.state.currentStep - 1];\n    store.updateData(values);\n\n    if (this.state.currentStep < steps.length) {\n      let finnalAsyncApi = action.asyncApi || step.asyncApi;\n\n      isEffectiveApi(finnalAsyncApi, store.data) &&\n        store.updateData({\n          [finishedField || 'finished']: false\n        });\n\n      if (isEffectiveApi(action.api || step.api, store.data)) {\n        store\n          .saveRemote(action.api || step.api, store.data, {\n            onSuccess: () => {\n              if (\n                !isEffectiveApi(finnalAsyncApi, store.data) ||\n                store.data[finishedField || 'finished']\n              ) {\n                return;\n              }\n\n              return until(\n                () => store.checkRemote(finnalAsyncApi as Api, store.data),\n                (ret: any) => ret && ret[finishedField || 'finished'],\n                cancel => (this.asyncCancel = cancel)\n              );\n            }\n          })\n          .then((value: any) =>\n            this.gotoStep(\n              value && typeof value.step === 'number'\n                ? value.step\n                : this.state.currentStep + 1\n            )\n          )\n          .catch(e => {\n            // do nothing\n          });\n      } else {\n        this.gotoStep(this.state.currentStep + 1);\n      }\n    } else {\n      // 最后一步\n      if (target) {\n        this.submitToTarget(target, store.data);\n      } else if (action.api || step.api || api) {\n        let finnalAsyncApi = action.asyncApi || step.asyncApi || asyncApi;\n\n        isEffectiveApi(finnalAsyncApi, store.data) &&\n          store.updateData({\n            [finishedField || 'finished']: false\n          });\n\n        const formStore = this.form\n          ? (this.form.props.store as IFormStore)\n          : store;\n        store.markSaving(true);\n\n        formStore\n          .saveRemote(action.api || step.api || api, store.data, {\n            onSuccess: () => {\n              if (\n                !isEffectiveApi(finnalAsyncApi, store.data) ||\n                store.data[finishedField || 'finished']\n              ) {\n                return;\n              }\n\n              return until(\n                () => store.checkRemote(finnalAsyncApi as Api, store.data),\n                (ret: any) => ret && ret[finishedField || 'finished'],\n                cancel => (this.asyncCancel = cancel)\n              );\n            }\n          })\n          .then(value => {\n            store.updateData({\n              ...store.data,\n              ...value\n            });\n            store.markSaving(false);\n\n            if (value && typeof value.step === 'number') {\n              this.gotoStep(value.step);\n            } else if (onFinished && onFinished(value, action) === false) {\n              // 如果是 false 后面的操作就不执行\n              return value;\n            }\n\n            if (redirect) {\n              env.updateLocation(filter(redirect, store.data));\n            } else if (reload) {\n              this.reloadTarget(reload, store.data);\n            }\n\n            return value;\n          })\n          .catch(e => {\n            store.markSaving(false);\n            console.error(e);\n          });\n      } else {\n        onFinished && onFinished(store.data, action);\n      }\n    }\n\n    return false;\n  }\n\n  handleDialogConfirm(\n    values: object[],\n    action: Action,\n    ctx: any,\n    targets: Array<any>\n  ) {\n    const {store} = this.props;\n\n    if (\n      action.mergeData &&\n      values.length === 1 &&\n      values[0] &&\n      targets[0].props.type === 'form'\n    ) {\n      store.updateData(values[0]);\n    }\n\n    store.closeDialog();\n  }\n\n  handleDialogClose() {\n    const {store} = this.props;\n    store.closeDialog();\n  }\n\n  renderSteps() {\n    const {steps, store, mode, classPrefix: ns} = this.props;\n    const currentStep = this.state.currentStep;\n\n    return (\n      <div\n        className={`${ns}Wizard-steps ${ns}Wizard--${mode}`}\n        id=\"form-wizard\"\n      >\n        {Array.isArray(steps) && steps.length ? (\n          <ul>\n            {steps.map((step, key) => {\n              const canJump = isJumpable(step, key, currentStep, store.data);\n\n              return (\n                <li\n                  key={key}\n                  className={cx({\n                    'is-complete': canJump,\n                    'is-active': currentStep === key + 1\n                  })}\n                  onClick={() => (canJump ? this.gotoStep(key + 1) : null)}\n                >\n                  <span\n                    className={cx('Badge', {\n                      // 'Badge--success': canJump && currentStep != key + 1,\n                      'is-active':\n                        currentStep === key + 1 ||\n                        (canJump && currentStep != key + 1)\n                    })}\n                  >\n                    {key + 1}\n                  </span>\n                  {step.title || step.label || `第 ${key + 1} 步`}\n                </li>\n              );\n            })}\n          </ul>\n        ) : null}\n      </div>\n    );\n  }\n\n  renderActions() {\n    const {\n      steps,\n      store,\n      readOnly,\n      disabled,\n      actionClassName,\n      actionPrevLabel,\n      actionNextLabel,\n      actionNextSaveLabel,\n      actionFinishLabel,\n      render,\n      classPrefix: ns,\n      classnames: cx\n    } = this.props;\n\n    if (!Array.isArray(steps)) {\n      return null;\n    }\n\n    const currentStepIndex = this.state.currentStep;\n    const nextStep = steps[currentStepIndex];\n    const prevStep = steps[currentStepIndex - 2];\n    const waiting = store.loading;\n    const step = steps[currentStepIndex - 1];\n\n    if (!step) {\n      return null;\n    }\n\n    const prevCanJump = prevStep\n      ? isJumpable(prevStep, currentStepIndex - 2, currentStepIndex, store.data)\n      : false;\n\n    if (step.actions && Array.isArray(step.actions)) {\n      return step.actions.length ? (\n        <div className={cx('Panel-footer')}>\n          {step.actions.map((action: Action, index: number) =>\n            render(`action/${index}`, action, {\n              key: index,\n              onAction: this.handleAction,\n              disabled:\n                action.disabled ||\n                waiting ||\n                disabled ||\n                (action.actionType === 'prev' && !prevCanJump) ||\n                (action.actionType === 'next' &&\n                  readOnly &&\n                  (!!step.api || !nextStep))\n            })\n          )}\n        </div>\n      ) : null;\n    }\n\n    return (\n      <div className={cx('Panel-footer')}>\n        {render(\n          `prev-btn`,\n          {\n            type: 'button',\n            label: actionPrevLabel,\n            actionType: 'prev',\n            className: actionClassName\n          },\n          {\n            disabled: waiting || !prevCanJump || disabled,\n            onAction: this.handleAction\n          }\n        )}\n\n        {render(\n          `next-btn`,\n          {\n            type: 'button',\n            label: !nextStep\n              ? actionFinishLabel\n              : !step.api\n              ? actionNextLabel\n              : actionNextSaveLabel,\n            actionType: 'next',\n            primary: !nextStep || !!step.api,\n            className: actionClassName\n          },\n          {\n            disabled:\n              waiting || disabled || (readOnly && (!!step.api || !nextStep)),\n            onAction: this.handleAction\n          }\n        )}\n      </div>\n    );\n  }\n\n  render() {\n    const {className, steps, render, store, mode, classPrefix: ns} = this.props;\n\n    const currentStep = this.state.currentStep;\n    const step = Array.isArray(steps) ? steps[currentStep - 1] : null;\n\n    return (\n      <div\n        ref={this.domRef}\n        className={cx(`${ns}Panel ${ns}Panel--default ${ns}Wizard`, className)}\n      >\n        {this.renderSteps()}\n        <div className={`${ns}Wizard-stepContent clearfix`}>\n          {step ? (\n            render(\n              'body',\n              {\n                ...step,\n                type: 'form',\n                wrapWithPanel: false,\n\n                // 接口相关需要外部来接管\n                api: null\n              },\n              {\n                key: this.state.currentStep,\n                ref: this.formRef,\n                onSubmit: this.handleSubmit,\n                onAction: this.handleAction,\n                disabled: store.loading,\n                popOverContainer: this.getPopOverContainer,\n                onChange: this.handleChange\n              }\n            )\n          ) : currentStep === -1 ? (\n            '初始中。。'\n          ) : (\n            <p className=\"text-danger\">配置错误</p>\n          )}\n        </div>\n\n        {render(\n          'dialog',\n          {\n            ...((store.action as Action) &&\n              ((store.action as Action).dialog as object)),\n            type: 'dialog'\n          },\n          {\n            key: 'dialog',\n            data: store.dialogData,\n            onConfirm: this.handleDialogConfirm,\n            onClose: this.handleDialogClose,\n            show: store.dialogOpen\n          }\n        )}\n        {this.renderActions()}\n\n        <Spinner size=\"lg\" overlay key=\"info\" show={store.loading} />\n      </div>\n    );\n  }\n}\n\nfunction isJumpable(step: any, index: number, currentStep: number, data: any) {\n  let canJump = false;\n\n  if (step && step.hasOwnProperty('jumpable')) {\n    canJump = step.jumpable;\n  } else if (step && step.jumpableOn) {\n    canJump = evalExpression(\n      step.jumpableOn,\n      createObject(data, {\n        currentStep\n      })\n    );\n  } else {\n    canJump = index + 1 < currentStep;\n  }\n\n  return canJump;\n}\n\n@Renderer({\n  test: /(^|\\/)wizard$/,\n  storeType: ServiceStore.name,\n  name: 'wizard',\n  isolateScope: true\n})\nexport class WizardRenderer extends Wizard {\n  static contextType = ScopedContext;\n\n  componentWillMount() {\n    const scoped = this.context as IScopedContext;\n    scoped.registerComponent(this);\n  }\n\n  componentWillUnmount() {\n    const scoped = this.context as IScopedContext;\n    scoped.unRegisterComponent(this);\n  }\n\n  doAction(action: Action, data: object, throwErrors: boolean = false) {\n    return this.handleAction(undefined, action, data, throwErrors);\n  }\n\n  submitToTarget(target: string, values: object) {\n    const scoped = this.context as IScopedContext;\n    scoped.send(target, values);\n  }\n\n  reloadTarget(target: string, data: any) {\n    const scoped = this.context as IScopedContext;\n    scoped.reload(target, data);\n  }\n\n  handleDialogConfirm(\n    values: object[],\n    action: Action,\n    ctx: any,\n    targets: Array<any>\n  ) {\n    super.handleDialogConfirm(values, action, ctx, targets);\n\n    const store = this.props.store;\n    const scoped = this.context as IScopedContext;\n    if (action.reload) {\n      scoped.reload(action.reload, store.data);\n    } else if (store.action && store.action.reload) {\n      scoped.reload(store.action.reload, store.data);\n    }\n  }\n}\n"
    ]
}