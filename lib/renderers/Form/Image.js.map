{
    "version": 3,
    "file": "Image.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Form/Image.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport {FormItem, FormControlProps} from './Item';\n// @require 'cropperjs/dist/cropper.css';\nimport Cropper from 'react-cropper';\nimport DropZone from 'react-dropzone';\nimport 'blueimp-canvastoblob';\nimport find = require('lodash/find');\nimport qs from 'qs';\nimport {Payload} from '../../types';\nimport {buildApi} from '../../utils/api';\nimport {createObject, qsstringify} from '../../utils/helper';\nimport {Icon} from '../../components/icons';\nimport Button from '../../components/Button';\n// @ts-ignore\nimport accepts from 'attr-accept';\n\nlet id = 1;\nfunction gennerateId() {\n  return id++;\n}\nlet preventEvent = (e: any) => e.stopPropagation();\n\nexport interface ImageProps extends FormControlProps {\n  placeholder?: string;\n  reciever?: string;\n  limit?: {\n    width?: number;\n    height?: number;\n    maxWidth?: number;\n    minWidth?: number;\n    maxHeight?: number;\n    minHeight?: number;\n    aspectRatio?: number;\n    aspectRatioLabel?: string;\n  };\n  crop?:\n    | boolean\n    | {\n        aspectRatio?: number;\n        [propName: string]: any;\n      };\n  accept?: string;\n\n  hideUploadButton?: boolean;\n  joinValues?: boolean;\n  extractValue?: boolean;\n  delimiter?: string;\n  autoUpload?: boolean;\n  multiple?: boolean;\n}\n\nexport interface ImageState {\n  uploading: boolean;\n  locked: boolean;\n  lockedReason?: string;\n  files: Array<FileValue | FileX>;\n  crop?: any;\n  error?: string;\n  cropFile?: FileValue;\n  submitOnChange?: boolean;\n}\n\nexport interface FileValue {\n  value?: any;\n  state: 'init' | 'error' | 'pending' | 'uploading' | 'uploaded' | 'invalid';\n  url?: string;\n  error?: string;\n  info?: {\n    width: number;\n    height: number;\n    len?: number;\n  };\n  [propName: string]: any;\n}\n\nexport interface FileX extends File {\n  id?: string | number;\n  preview?: string;\n  state?: 'init' | 'error' | 'pending' | 'uploading' | 'uploaded' | 'invalid';\n  progress?: number;\n  [propName: string]: any;\n}\n\nexport default class ImageControl extends React.Component<\n  ImageProps,\n  ImageState\n> {\n  static defaultProps = {\n    limit: undefined,\n    accept: 'image/jpeg, image/jpg, image/png, image/gif',\n    reciever: '/api/upload',\n    hideUploadButton: false,\n    placeholder: '点击选择图片或者将图片拖入该区域',\n    joinValues: true,\n    extractValue: false,\n    delimiter: ',',\n    autoUpload: true,\n    multiple: false\n  };\n\n  static formatFileSize(\n    size: number | string,\n    units = [' B', ' KB', ' M', ' G']\n  ) {\n    size = parseInt(size as string, 10) || 0;\n\n    while (size > 1024 && units.length > 1) {\n      size /= 1024;\n      units.shift();\n    }\n\n    return size.toFixed(2) + units[0];\n  }\n\n  static valueToFile(\n    value: string | object,\n    props?: ImageProps\n  ): FileValue | undefined {\n    return value\n      ? {\n          ...(typeof value === 'string'\n            ? {\n                value,\n                url: value,\n                id: gennerateId()\n              }\n            : value),\n          state: 'init'\n        }\n      : undefined;\n  }\n\n  static sizeInfo(width?: number, height?: number): string {\n    if (!width) {\n      return `高度${height}px`;\n    } else if (!height) {\n      return `宽度${width}px`;\n    }\n\n    return `尺寸（${width} x ${height}）`;\n  }\n\n  state: ImageState = {\n    uploading: false,\n    locked: false,\n    files: []\n  };\n\n  cropper = React.createRef<Cropper>();\n  dropzone = React.createRef<any>();\n  current: FileValue | FileX | null = null;\n  resolve?: (value?: any) => void;\n\n  constructor(props: ImageProps) {\n    super(props);\n    const value: string | Array<string | FileValue> | FileValue = props.value;\n    const multiple = props.multiple;\n    const joinValues = props.joinValues;\n    const delimiter = props.delimiter as string;\n    let files: Array<FileValue> = [];\n\n    if (value) {\n      // files = (multiple && Array.isArray(value) ? value : joinValues ? (value as string).split(delimiter) : [value])\n      files = (Array.isArray(value)\n        ? value\n        : joinValues && typeof value === 'string' && multiple\n        ? (value as string).split(delimiter)\n        : [value]\n      )\n        .map(item => ImageControl.valueToFile(item) as FileValue)\n        .filter(item => item);\n    }\n\n    this.state = {\n      ...this.state,\n      files: files,\n      crop: this.buildCrop(props)\n    };\n\n    this.sendFile = this.sendFile.bind(this);\n    this.removeFile = this.removeFile.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleCrop = this.handleCrop.bind(this);\n    this.handleDropRejected = this.handleDropRejected.bind(this);\n    this.cancelCrop = this.cancelCrop.bind(this);\n    this.handleImageLoaded = this.handleImageLoaded.bind(this);\n    this.startUpload = this.startUpload.bind(this);\n    this.stopUpload = this.stopUpload.bind(this);\n    this.toggleUpload = this.toggleUpload.bind(this);\n    this.tick = this.tick.bind(this);\n    this.onChange = this.onChange.bind(this);\n    this.addFiles = this.addFiles.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.handlePaste = this.handlePaste.bind(this);\n  }\n\n  componentWillReceiveProps(nextProps: ImageProps) {\n    const props = this.props;\n\n    if (props.value !== nextProps.value) {\n      const value: string | Array<string | FileValue> | FileValue =\n        nextProps.value;\n      const multiple = nextProps.multiple;\n      const joinValues = nextProps.joinValues;\n      const delimiter = nextProps.delimiter as string;\n\n      let files: Array<FileValue> = [];\n\n      if (value) {\n        files = (Array.isArray(value)\n          ? value\n          : joinValues && typeof value === 'string'\n          ? (value as string).split(delimiter)\n          : [value]\n        )\n          .map(item => {\n            let obj = ImageControl.valueToFile(item, nextProps) as FileValue;\n            let org;\n\n            if (\n              obj &&\n              (org = find(\n                this.state.files,\n                item => (item as FileValue).value === obj.value\n              ))\n            ) {\n              obj = {\n                ...org,\n                ...obj,\n                id: org.id || obj.id\n              };\n            }\n\n            return obj;\n          })\n          .filter(item => item);\n      }\n\n      this.setState({\n        files\n      });\n    }\n\n    if (props.crop !== nextProps.crop) {\n      this.setState({\n        crop: this.buildCrop(nextProps)\n      });\n    }\n  }\n\n  buildCrop(props: ImageProps) {\n    let crop = props.crop;\n\n    if (crop && props.multiple) {\n      props.env &&\n        props.env.alert &&\n        props.env.alert('图片多选配置和裁剪配置冲突，目前不能二者都支持！');\n      return null;\n    }\n\n    if (crop === true) {\n      crop = {};\n    }\n\n    if (crop) {\n      crop = {\n        aspectRatio: 1, // 1 : 1\n        guides: true,\n        dragMode: 'move',\n        viewMode: 1,\n        rotatable: false,\n        scalable: false,\n        ...crop\n      };\n    }\n\n    return crop;\n  }\n\n  handleDropRejected(rejectedFiles: any, evt: React.DragEvent<any>) {\n    if (evt.type !== 'change' && evt.type !== 'drop') {\n      return;\n    }\n    const {multiple, env, accept} = this.props;\n\n    const files = rejectedFiles.map((file: any) => ({\n      ...file,\n      state: 'invalid',\n      id: gennerateId(),\n      name: file.name\n    }));\n\n    this.setState({\n      files: multiple\n        ? this.state.files.concat(files)\n        : this.state.files.length\n        ? this.state.files\n        : files.slice(0, 1)\n    });\n\n    env.alert(\n      `您添加的文件${files.map(\n        (item: any) => `【${item.name}】`\n      )}不符合类型的\\`${accept}\\`设定，请仔细检查。`\n    );\n  }\n\n  startUpload() {\n    if (this.state.uploading) {\n      return;\n    }\n\n    this.setState(\n      {\n        uploading: true,\n        locked: true,\n        files: this.state.files.map(file => {\n          if (file.state === 'error') {\n            file.state = 'pending';\n          }\n\n          return file;\n        })\n      },\n      this.tick\n    );\n  }\n\n  toggleUpload() {\n    return this.state.uploading ? this.stopUpload() : this.startUpload();\n  }\n\n  stopUpload() {\n    if (!this.state.uploading) {\n      return;\n    }\n\n    this.setState({\n      uploading: false\n    });\n  }\n\n  tick() {\n    if (this.current || !this.state.uploading) {\n      return;\n    }\n\n    const file = find(\n      this.state.files,\n      item => item.state === 'pending'\n    ) as FileX;\n    if (file) {\n      this.current = file;\n\n      file.state = 'uploading';\n      this.setState(\n        {\n          files: this.state.files.concat()\n        },\n        () =>\n          this.sendFile(\n            file as FileX,\n            (error, file, obj) => {\n              const files = this.state.files.concat();\n              const idx = files.indexOf(file);\n\n              if (!~idx) {\n                return;\n              }\n\n              let newFile: FileX | FileValue = file;\n\n              if (error) {\n                newFile.state =\n                  file.state !== 'uploading' ? file.state : 'error';\n                newFile.error = error;\n\n                if (!this.props.multiple && newFile.state === 'invalid') {\n                  files.splice(idx, 1);\n                  this.current = null;\n\n                  return this.setState(\n                    {\n                      files: files,\n                      error: error\n                    },\n                    this.tick\n                  );\n                }\n              } else {\n                newFile = obj as FileValue;\n              }\n              files.splice(idx, 1, newFile);\n              this.current = null;\n              this.setState(\n                {\n                  files: files\n                },\n                this.tick\n              );\n            },\n            progress => {\n              const files = this.state.files.concat();\n              const idx = files.indexOf(file);\n\n              if (!~idx) {\n                return;\n              }\n\n              // file 是个非 File 对象，先不copy了直接改。\n              file.progress = progress;\n              this.setState({\n                files\n              });\n            }\n          )\n      );\n    } else {\n      this.setState(\n        {\n          uploading: false,\n          locked: false\n        },\n        () => {\n          this.onChange();\n\n          if (this.resolve) {\n            this.resolve(\n              this.state.files.some(file => file.state === 'error')\n                ? '文件上传失败请重试'\n                : null\n            );\n            this.resolve = undefined;\n          }\n        }\n      );\n    }\n  }\n\n  removeFile(file: FileValue, index: number) {\n    const files = this.state.files.concat();\n\n    files.splice(index, 1);\n\n    this.setState(\n      {\n        files: files\n      },\n      this.onChange\n    );\n  }\n\n  editImage(index: number) {\n    const {multiple} = this.props;\n\n    const files = this.state.files;\n\n    this.setState({\n      cropFile: {\n        preview: files[index].url as string,\n        state: 'init'\n      }\n    });\n  }\n\n  onChange() {\n    const {\n      multiple,\n      onChange,\n      joinValues,\n      extractValue,\n      delimiter,\n      valueField\n    } = this.props;\n\n    const files = this.state.files.filter(\n      file => file.state == 'uploaded' || file.state == 'init'\n    );\n\n    let newValue: any = files.length\n      ? joinValues\n        ? files[0].value\n        : files[0]\n      : '';\n\n    if (multiple) {\n      newValue = joinValues\n        ? files.map(item => item.value).join(delimiter)\n        : extractValue\n        ? files.map(item => item.value)\n        : files;\n    } else {\n      newValue = joinValues\n        ? newValue.value || newValue\n        : extractValue\n        ? newValue[valueField || 'value']\n        : newValue;\n    }\n\n    onChange(newValue);\n  }\n\n  handleSelect() {\n    this.dropzone.current && this.dropzone.current.open();\n  }\n\n  handleDrop(files: Array<FileX>) {\n    const {multiple, crop} = this.props;\n\n    if (crop && !multiple) {\n      const file = files[0] as FileValue;\n      if (!file.preview || !file.url) {\n        file.preview = window.URL.createObjectURL(file);\n      }\n\n      return this.setState({\n        locked: true,\n        lockedReason: '请选择放弃或者应用',\n        cropFile: file\n      });\n    }\n\n    this.addFiles(files);\n  }\n\n  handlePaste(e: React.ClipboardEvent<any>) {\n    const event = e.nativeEvent as any;\n    const files: Array<FileX> = [];\n    const items = event.clipboardData.items;\n    const accept = this.props.accept;\n\n    [].slice.call(items).forEach((item: DataTransferItem) => {\n      let blob: FileX;\n\n      if (\n        item.kind !== 'file' ||\n        !(blob = item.getAsFile() as File) ||\n        !accepts(blob, accept)\n      ) {\n        return;\n      }\n\n      blob.id = gennerateId();\n      files.push(blob);\n    });\n\n    this.handleDrop(files);\n  }\n\n  handleCrop() {\n    this.cropper.current!.getCroppedCanvas().toBlob((file: File) => {\n      this.addFiles([file]);\n      this.setState({\n        cropFile: undefined,\n        locked: false,\n        lockedReason: ''\n      });\n    });\n  }\n\n  cancelCrop() {\n    this.setState(\n      {\n        cropFile: undefined,\n        locked: false,\n        lockedReason: ''\n      },\n      this.onChange\n    );\n  }\n\n  addFiles(files: Array<FileX>) {\n    if (!files.length) {\n      return;\n    }\n\n    const {multiple, maxLength, maxSize, accept} = this.props;\n    let currentFiles = this.state.files;\n\n    if (!multiple && currentFiles.length) {\n      currentFiles = [];\n    }\n\n    const allowed =\n      (multiple\n        ? maxLength\n          ? maxLength\n          : files.length + currentFiles.length\n        : 1) - currentFiles.length;\n    const inputFiles: Array<FileX> = [];\n\n    [].slice.call(files, 0, allowed).forEach((file: FileX) => {\n      if (maxSize && file.size > maxSize) {\n        alert(\n          `您选择的文件 ${file.name} 大小为 ${ImageControl.formatFileSize(\n            file.size\n          )} 超出了最大为 ${ImageControl.formatFileSize(\n            maxSize\n          )} 的限制，请重新选择`\n        );\n        return;\n      }\n\n      file.state = 'pending';\n      file.id = gennerateId();\n      if (!file.preview || !file.url) {\n        file.preview = window.URL.createObjectURL(file);\n      }\n      inputFiles.push(file);\n    });\n\n    if (!inputFiles.length) {\n      return;\n    }\n\n    this.setState(\n      {\n        error: undefined,\n        files: currentFiles.concat(inputFiles),\n        locked: true\n      },\n      () => {\n        const {autoUpload} = this.props;\n\n        if (autoUpload) {\n          this.startUpload();\n        }\n      }\n    );\n  }\n\n  sendFile(\n    file: FileX,\n    cb: (error: null | string, file: FileX, obj?: FileValue) => void,\n    onProgress: (progress: number) => void\n  ) {\n    const {limit} = this.props;\n\n    if (!limit) {\n      return this._upload(file, cb, onProgress);\n    }\n\n    const image = new Image();\n    image.onload = () => {\n      const width = image.width;\n      const height = image.height;\n      let error = '';\n\n      if (\n        (limit.width && limit.width != width) ||\n        (limit.height && limit.height != height)\n      ) {\n        error = `您选择的图片不符合尺寸要求, 请上传${ImageControl.sizeInfo(\n          limit.width,\n          limit.height\n        )}的图片`;\n      } else if (\n        (limit.maxWidth && limit.maxWidth < width) ||\n        (limit.maxHeight && limit.maxHeight < height)\n      ) {\n        error = `您选择的图片不符合尺寸要求, 请上传不要超过${ImageControl.sizeInfo(\n          limit.maxWidth,\n          limit.maxHeight\n        )}的图片`;\n      } else if (\n        (limit.minWidth && limit.minWidth > width) ||\n        (limit.minHeight && limit.minHeight > height)\n      ) {\n        error = `您选择的图片不符合尺寸要求, 请上传不要小于${ImageControl.sizeInfo(\n          limit.minWidth,\n          limit.minHeight\n        )}的图片`;\n      } else if (\n        limit.aspectRatio &&\n        Math.abs(width / height - limit.aspectRatio) > 0.01\n      ) {\n        error = `您选择的图片不符合尺寸要求, 请上传尺寸比率为 ${limit.aspectRatioLabel ||\n          limit.aspectRatio} 的图片`;\n      }\n\n      if (error) {\n        file.state = 'invalid';\n        cb(error, file);\n      } else {\n        this._upload(file, cb, onProgress);\n      }\n    };\n    image.src = (file.preview || file.url) as string;\n  }\n\n  _upload(\n    file: Blob,\n    cb: (error: null | string, file: Blob, obj?: FileValue) => void,\n    onProgress: (progress: number) => void\n  ) {\n    this._send(file, this.props.reciever as string, {}, onProgress)\n      .then((ret: Payload) => {\n        if (ret.status) {\n          throw new Error(ret.msg || '上传失败, 请重试');\n        }\n\n        const obj: FileValue = {\n          ...ret.data,\n          state: 'uploaded'\n        };\n        obj.value = obj.value || obj.url;\n\n        cb(null, file, obj);\n      })\n      .catch(error => cb(error.message || '上传失败，请重试', file));\n  }\n\n  _send(\n    file: Blob,\n    reciever: string,\n    params: object,\n    onProgress: (progress: number) => void\n  ): Promise<Payload> {\n    const fd = new FormData();\n    const data = this.props.data;\n    const api = buildApi(reciever, createObject(data, params), {\n      method: 'post'\n    });\n    const fileField = this.props.fileField || 'file';\n    fd.append(fileField, file, (file as File).name);\n\n    const idx = api.url.indexOf('?');\n\n    if (~idx && params) {\n      params = {\n        ...qs.parse(reciever.substring(idx + 1)),\n        ...params\n      };\n      api.url = api.url.substring(0, idx) + '?' + qsstringify(params);\n    } else if (params) {\n      api.url += '?' + qsstringify(params);\n    }\n\n    if (api.data) {\n      qsstringify(api.data)\n        .split('&')\n        .forEach(item => {\n          let parts = item.split('=');\n          fd.append(parts[0], parts[1]);\n        });\n    }\n\n    const env = this.props.env;\n\n    if (!env || !env.fetcher) {\n      throw new Error('fetcher is required');\n    }\n\n    return env.fetcher(api, fd, {\n      method: 'post',\n      onUploadProgress: (event: {loaded: number; total: number}) =>\n        onProgress(event.loaded / event.total)\n    });\n  }\n\n  handleClick() {\n    (this.refs.dropzone as any).open();\n  }\n\n  handleImageLoaded(index: number, e: React.UIEvent<any>) {\n    const imgDom = e.currentTarget;\n    const img = new Image();\n    img.onload = () => {\n      delete img.onload;\n      const files = this.state.files.concat();\n      const file = files[index];\n\n      if (!file) {\n        return;\n      }\n\n      file.info = {\n        ...file.info,\n        width: img.width,\n        height: img.height\n      };\n\n      files.splice(index, 1, file);\n      const needUploading = !!(\n        this.current || find(files, file => file.state === 'pending')\n      );\n\n      this.setState(\n        {\n          files: files\n        },\n        !needUploading ? this.onChange : undefined\n      );\n    };\n    img.src = imgDom.src;\n  }\n\n  validate(): any {\n    if (this.state.locked && this.state.lockedReason) {\n      return this.state.lockedReason;\n    } else if (\n      this.state.uploading ||\n      this.state.files.some(item => item.state === 'pending')\n    ) {\n      return new Promise(resolve => {\n        this.resolve = resolve;\n        this.startUpload();\n      });\n    } else if (this.state.files.some(item => item.state === 'error')) {\n      return '文件上传失败请重试';\n    }\n  }\n\n  render() {\n    const {\n      className,\n      classnames: cx,\n      placeholder,\n      disabled,\n      multiple,\n      accept,\n      maxLength,\n      autoUpload,\n      hideUploadButton\n    } = this.props;\n\n    const {files, error, crop, uploading, cropFile} = this.state;\n\n    const hasPending = files.some(file => file.state == 'pending');\n    return (\n      <div className={cx(`ImageControl`, className)}>\n        {cropFile ? (\n          <div className={cx('ImageControl-cropperWrapper')}>\n            <Cropper {...crop} ref={this.cropper} src={cropFile.preview} />\n            <div className={cx('ImageControl-croperToolbar')}>\n              <a\n                className={cx('ImageControl-cropCancel')}\n                onClick={this.cancelCrop}\n                data-tooltip=\"取消\"\n                data-position=\"left\"\n              >\n                <Icon icon=\"close\" className=\"icon\" />\n              </a>\n              <a\n                className={cx('ImageControl-cropConfirm')}\n                onClick={this.handleCrop}\n                data-tooltip=\"确认\"\n                data-position=\"left\"\n              >\n                <Icon icon=\"check\" className=\"icon\" />\n              </a>\n            </div>\n          </div>\n        ) : (\n          <DropZone\n            key=\"drop-zone\"\n            ref={this.dropzone}\n            onDrop={this.handleDrop}\n            onDropRejected={this.handleDropRejected}\n            accept={accept}\n            multiple={multiple}\n          >\n            {({\n              getRootProps,\n              getInputProps,\n              isDragActive,\n              isDragAccept,\n              isDragReject,\n              isFocused\n            }) => (\n              <div\n                {...getRootProps({\n                  onClick: preventEvent,\n                  onPaste: this.handlePaste,\n                  className: cx('ImageControl-dropzone', {\n                    disabled,\n                    'is-empty': !files.length,\n                    'is-active': isDragActive\n                  })\n                })}\n              >\n                <input {...getInputProps()} />\n\n                {isDragActive || isDragAccept || isDragReject ? (\n                  <div\n                    className={cx('ImageControl-acceptTip', {\n                      'is-accept': isDragAccept,\n                      'is-reject': isDragReject\n                    })}\n                  >\n                    把图片拖到这，然后松完成添加！\n                  </div>\n                ) : (\n                  <>\n                    {files && files.length\n                      ? files.map((file, key) => (\n                          <div\n                            key={file.id || key}\n                            className={cx('ImageControl-item', {\n                              'is-uploaded': file.state !== 'uploading',\n                              'is-invalid':\n                                file.state === 'error' ||\n                                file.state === 'invalid'\n                            })}\n                          >\n                            {file.state === 'invalid' ||\n                            file.state === 'error' ? (\n                              <a\n                                className={cx('ImageControl-retryBtn', {\n                                  'is-disabled': disabled\n                                })}\n                                onClick={this.handleSelect}\n                              >\n                                <Icon icon=\"retry\" className=\"icon\" />\n                                <p className=\"ImageControl-itemInfoError\">\n                                  重新上传\n                                </p>\n                              </a>\n                            ) : file.state === 'uploading' ? (\n                              <>\n                                <a\n                                  onClick={this.removeFile.bind(\n                                    this,\n                                    file,\n                                    key\n                                  )}\n                                  key=\"clear\"\n                                  className={cx('ImageControl-itemClear')}\n                                  data-tooltip=\"移除\"\n                                >\n                                  <Icon icon=\"close\" className=\"icon\" />\n                                </a>\n                                <div\n                                  key=\"info\"\n                                  className={cx('ImageControl-itemInfo')}\n                                >\n                                  <p>文件上传中</p>\n                                  <div className={cx('ImageControl-progress')}>\n                                    <span\n                                      style={{\n                                        width: `${Math.round(\n                                          file.progress * 100\n                                        )}%`\n                                      }}\n                                      className={cx(\n                                        'ImageControl-progressValue'\n                                      )}\n                                    />\n                                  </div>\n                                </div>\n                              </>\n                            ) : (\n                              <>\n                                <div\n                                  key=\"image\"\n                                  className={cx('ImageControl-itemImageWrap')}\n                                >\n                                  <img\n                                    onLoad={this.handleImageLoaded.bind(\n                                      this,\n                                      key\n                                    )}\n                                    src={file.url || file.preview}\n                                    alt={file.name}\n                                  />\n                                </div>\n\n                                <div\n                                  key=\"overlay\"\n                                  className={cx('ImageControl-itemOverlay')}\n                                >\n                                  {file.info ? (\n                                    [\n                                      <div key=\"1\">\n                                        {file.info.width} x {file.info.height}\n                                      </div>,\n                                      file.info.len ? (\n                                        <div key=\"2\">\n                                          {ImageControl.formatFileSize(\n                                            file.info.len\n                                          )}\n                                        </div>\n                                      ) : null\n                                    ]\n                                  ) : (\n                                    <div>...</div>\n                                  )}\n\n                                  {!disabled ? (\n                                    <a\n                                      data-tooltip=\"查看大图\"\n                                      data-position=\"bottom\"\n                                      target=\"_blank\"\n                                      href={file.url || file.preview}\n                                    >\n                                      <Icon icon=\"view\" className=\"icon\" />\n                                    </a>\n                                  ) : null}\n                                  {!!crop && !disabled ? (\n                                    <a\n                                      data-tooltip=\"裁剪图片\"\n                                      data-position=\"bottom\"\n                                      onClick={this.editImage.bind(this, key)}\n                                    >\n                                      <Icon icon=\"pencil\" className=\"icon\" />\n                                    </a>\n                                  ) : null}\n                                  {!disabled ? (\n                                    <a\n                                      data-tooltip=\"移除\"\n                                      data-position=\"bottom\"\n                                      onClick={this.removeFile.bind(\n                                        this,\n                                        file,\n                                        key\n                                      )}\n                                    >\n                                      <Icon icon=\"remove\" className=\"icon\" />\n                                    </a>\n                                  ) : null}\n                                </div>\n                              </>\n                            )}\n                          </div>\n                        ))\n                      : null}\n\n                    {(multiple && (!maxLength || files.length < maxLength)) ||\n                    (!multiple && !files.length) ? (\n                      <label\n                        className={cx('ImageControl-addBtn', {\n                          'is-disabled': disabled\n                        })}\n                        onClick={this.handleSelect}\n                        data-tooltip={placeholder}\n                        data-position=\"right\"\n                      >\n                        <Icon icon=\"plus\" className=\"icon\" />\n\n                        {isFocused ? (\n                          <span className={cx('ImageControl-pasteTip')}>\n                            当前状态支持从剪切板中粘贴图片文件。\n                          </span>\n                        ) : null}\n                      </label>\n                    ) : null}\n\n                    {!autoUpload && !hideUploadButton && files.length ? (\n                      <Button\n                        level=\"default\"\n                        className={cx('ImageControl-uploadBtn')}\n                        disabled={!hasPending}\n                        onClick={this.toggleUpload}\n                      >\n                        {uploading ? '暂停上传' : '开始上传'}\n                      </Button>\n                    ) : null}\n\n                    {error ? (\n                      <div className={cx('ImageControl-errorMsg')}>{error}</div>\n                    ) : null}\n                  </>\n                )}\n              </div>\n            )}\n          </DropZone>\n        )}\n      </div>\n    );\n  }\n}\n\n@FormItem({\n  type: 'image',\n  sizeMutable: false\n})\nexport class ImageControlRenderer extends ImageControl {}\n"
    ]
}