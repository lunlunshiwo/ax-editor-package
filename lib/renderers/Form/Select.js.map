{
    "version": 3,
    "file": "Select.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Form/Select.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport cx from 'classnames';\nimport {OptionsControl, OptionsControlProps, Option} from './Options';\nimport Select from '../../components/Select';\nimport find = require('lodash/find');\nimport debouce = require('lodash/debounce');\nimport {Api} from '../../types';\nimport {isEffectiveApi} from '../../utils/api';\nimport {isEmpty, createObject} from '../../utils/helper';\nimport {dataMapping} from '../../utils/tpl-builtin';\n\nexport interface SelectProps extends OptionsControlProps {\n  autoComplete?: Api;\n  searchable?: boolean;\n}\n\nexport default class SelectControl extends React.Component<SelectProps, any> {\n  static defaultProps: Partial<SelectProps> = {\n    clearable: false,\n    searchable: false\n  };\n\n  input: any;\n  cache: {\n    [propName: string]: any;\n  } = {};\n  constructor(props: SelectProps) {\n    super(props);\n\n    this.changeValue = this.changeValue.bind(this);\n    this.loadRemote = debouce(this.loadRemote.bind(this), 250, {\n      trailing: true,\n      leading: false\n    });\n    this.inputRef = this.inputRef.bind(this);\n  }\n\n  inputRef(ref: any) {\n    this.input = ref;\n  }\n\n  foucs() {\n    this.input && this.input.focus();\n  }\n\n  changeValue(value: Option | Array<Option> | void) {\n    const {\n      joinValues,\n      extractValue,\n      delimiter,\n      multiple,\n      type,\n      valueField,\n      onChange,\n      setOptions,\n      options,\n      autoFill,\n      onBulkChange\n    } = this.props;\n\n    let newValue: string | Option | Array<Option> | void = value;\n    let additonalOptions: Array<any> = [];\n\n    (Array.isArray(value) ? value : value ? [value] : []).forEach(\n      (option: any) => {\n        let resolved = find(\n          options,\n          (item: any) =>\n            item[valueField || 'value'] == option[valueField || 'value']\n        );\n        resolved || additonalOptions.push(option);\n      }\n    );\n\n    if (joinValues) {\n      if (multiple) {\n        newValue = Array.isArray(value)\n          ? (value\n              .map(item => item[valueField || 'value'])\n              .join(delimiter) as string)\n          : value\n          ? (value as Option)[valueField || 'value']\n          : '';\n      } else {\n        newValue = newValue ? (newValue as Option)[valueField || 'value'] : '';\n      }\n    } else if (extractValue) {\n      if (multiple) {\n        newValue = Array.isArray(value)\n          ? value.map(item => item[valueField || 'value'])\n          : value\n          ? [(value as Option)[valueField || 'value']]\n          : [''];\n      } else {\n        newValue = newValue ? (newValue as Option)[valueField || 'value'] : '';\n      }\n    }\n\n    // 不设置没法回显\n    additonalOptions.length && setOptions(options.concat(additonalOptions));\n\n    const sendTo =\n      !multiple &&\n      autoFill &&\n      !isEmpty(autoFill) &&\n      dataMapping(autoFill, value as Option);\n    sendTo && onBulkChange(sendTo);\n    onChange(newValue);\n  }\n\n  loadRemote(input: string) {\n    const {autoComplete, env, data, setOptions, setLoading} = this.props;\n\n    if (!env || !env.fetcher) {\n      throw new Error('fetcher is required');\n    }\n\n    if (this.cache[input] || ~input.indexOf(\"'\") /*中文没输完 233*/) {\n      let options = this.cache[input] || [];\n      let combinedOptions = this.mergeOptions(options);\n      setOptions(combinedOptions);\n\n      return Promise.resolve({\n        options: combinedOptions\n      });\n    }\n\n    setLoading(true);\n    return (\n      isEffectiveApi(autoComplete, data) &&\n      env\n        .fetcher(\n          autoComplete,\n          createObject(data, {\n            term: input,\n            value: input\n          })\n        )\n        .then(ret => {\n          let options =\n            (ret.data && (ret.data as any).options) || ret.data || [];\n          this.cache[input] = options;\n          let combinedOptions = this.mergeOptions(options);\n          setOptions(combinedOptions);\n\n          return Promise.resolve({\n            options: combinedOptions\n          });\n        })\n        .finally(() => setLoading(false))\n    );\n  }\n\n  mergeOptions(options: Array<object>) {\n    const {selectedOptions} = this.props;\n    let combinedOptions = options.concat();\n\n    if (Array.isArray(selectedOptions) && selectedOptions.length) {\n      selectedOptions.forEach(option => {\n        if (\n          !find(combinedOptions, (item: Option) => item.value == option.value)\n        ) {\n          combinedOptions.push(option);\n        }\n      });\n    }\n    return combinedOptions;\n  }\n\n  reload() {\n    const reload = this.props.reloadOptions;\n    reload && reload();\n  }\n\n  render() {\n    let {\n      autoComplete,\n      searchable,\n      options,\n      className,\n      loading,\n      value,\n      selectedOptions,\n      multi,\n      multiple,\n      placeholder,\n      id,\n      classPrefix,\n      classnames,\n      creatable,\n      inline,\n      noResultsText,\n      render,\n      ...rest\n    } = this.props;\n\n    if (noResultsText && /<\\w+/.test(noResultsText)) {\n      noResultsText = render('noResultText', noResultsText);\n    }\n\n    return (\n      <div className={cx(`${classPrefix}SelectControl`, className)}>\n        <Select\n          {...rest}\n          placeholder={placeholder}\n          multiple={multiple || multi}\n          ref={this.inputRef}\n          value={selectedOptions}\n          options={options}\n          loadOptions={\n            isEffectiveApi(autoComplete) ? this.loadRemote : undefined\n          }\n          creatable={creatable}\n          searchable={searchable || !!autoComplete}\n          onChange={this.changeValue}\n          loading={loading}\n          noResultsText={noResultsText}\n        />\n      </div>\n    );\n  }\n}\n\n@OptionsControl({\n  type: 'select'\n})\nexport class SelectControlRenderer extends SelectControl {}\n\n@OptionsControl({\n  type: 'multi-select'\n})\nexport class MultiSelectControlRenderer extends SelectControl {\n  static defaultProps = {\n    multiple: true\n  };\n}\n"
    ]
}