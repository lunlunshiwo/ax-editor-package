{
    "version": 3,
    "file": "NestedSelect.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Form/NestedSelect.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport xorBy = require('lodash/xorBy');\nimport unionBy = require('lodash/unionBy');\nimport Overlay from '../../components/Overlay';\nimport Checkbox from '../../components/Checkbox';\nimport PopOver from '../../components/PopOver';\nimport {RootCloseWrapper} from 'react-overlays';\nimport {Icon} from '../../components/icons';\nimport {autobind, flattenTree, isEmpty} from '../../utils/helper';\nimport {dataMapping} from '../../utils/tpl-builtin';\n\nimport {OptionsControl, OptionsControlProps, Option} from '../Form/Options';\n\nexport interface NestedSelectProps extends OptionsControlProps {\n  cascade?: boolean;\n  withChildren?: boolean;\n}\n\nexport interface NestedSelectState {\n  isOpened?: boolean;\n}\n\nexport default class NestedSelectControl extends React.Component<\n  NestedSelectProps,\n  NestedSelectState\n> {\n  static defaultProps: Partial<NestedSelectProps> = {\n    cascade: false,\n    withChildren: false\n  };\n  target: any;\n  alteredOptions: any;\n  state = {\n    isOpened: false\n  };\n\n  @autobind\n  domRef(ref: any) {\n    this.target = ref;\n  }\n\n  @autobind\n  open() {\n    if (!this.props.disabled) {\n      this.setState({\n        isOpened: true\n      });\n    }\n  }\n\n  @autobind\n  close() {\n    this.setState({\n      isOpened: false\n    });\n  }\n\n  renderValue() {\n    const {multiple, classnames: cx, selectedOptions, labelField} = this.props;\n    const len = Array.isArray(selectedOptions) ? selectedOptions.length : 0;\n    return (\n      <div className={cx('NestedSelect-valueWrap')} onClick={this.open}>\n        {len > 0 ? (\n          <div className={cx('NestedSelect-value')}>\n            {multiple\n              ? `已选择 ${len} 项`\n              : selectedOptions[0][labelField || 'label']}\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n\n  renderClear() {\n    const {clearable, value, disabled, classnames: cx} = this.props;\n\n    return clearable &&\n      !disabled &&\n      (Array.isArray(value) ? value.length : value) ? (\n      <a onClick={this.clearValue} className={cx('NestedSelect-clear')}>\n        <Icon icon=\"close\" className=\"icon\" />\n      </a>\n    ) : null;\n  }\n\n  @autobind\n  clearValue() {\n    const {onChange, resetValue} = this.props;\n\n    onChange(typeof resetValue === 'undefined' ? '' : resetValue);\n  }\n\n  handleOptionClick(option: Option, e: React.MouseEvent<HTMLElement>) {\n    const {\n      multiple,\n      onChange,\n      joinValues,\n      extractValue,\n      valueField,\n      autoFill,\n      onBulkChange\n    } = this.props;\n\n    e.stopPropagation();\n\n    const sendTo =\n      !multiple &&\n      autoFill &&\n      !isEmpty(autoFill) &&\n      dataMapping(autoFill, option);\n    sendTo && onBulkChange(sendTo);\n\n    onChange(\n      joinValues\n        ? option[valueField || 'value']\n        : extractValue\n        ? option[valueField || 'value']\n        : option\n    );\n    !multiple && this.close();\n  }\n\n  handleCheck(option: any | Array<any>) {\n    const {\n      onChange,\n      selectedOptions,\n      joinValues,\n      valueField,\n      delimiter,\n      extractValue,\n      withChildren,\n      cascade\n    } = this.props;\n\n    const items = selectedOptions.concat();\n    let newValue;\n\n    // 三种情况：\n    // 1.全选，option为数组\n    // 2.单个选中，且有children\n    // 3.单个选中，没有children\n\n    if (Array.isArray(option)) {\n      option = withChildren ? flattenTree(option) : option;\n      newValue = items.length === option.length ? [] : option;\n    } else if (Array.isArray(option.children)) {\n      if (cascade) {\n        newValue = xorBy(items, [option], valueField || 'value');\n      } else if (withChildren) {\n        option = flattenTree([option]);\n        const fn = option.every((opt: any) => !!~items.indexOf(opt))\n          ? xorBy\n          : unionBy;\n        newValue = fn(items, option, valueField || 'value');\n      } else {\n        newValue = items.filter(item => !~flattenTree([option]).indexOf(item));\n        !~items.indexOf(option) && newValue.push(option);\n      }\n    } else {\n      newValue = xorBy(items, [option], valueField || 'value');\n    }\n\n    if (joinValues) {\n      newValue = newValue\n        .map((item: any) => item[valueField || 'value'])\n        .join(delimiter || ',');\n    } else if (extractValue) {\n      newValue = newValue.map((item: any) => item[valueField || 'value']);\n    }\n\n    onChange(newValue);\n  }\n\n  allChecked(options: Array<any>): boolean {\n    return options.every((option: any) => {\n      if (option.children) {\n        return this.allChecked(option.children);\n      }\n      return this.props.selectedOptions.some(\n        selectedOption => selectedOption.value == option.value\n      );\n    });\n  }\n\n  partialChecked(options: Array<any>): boolean {\n    return options.some((option: any) => {\n      if (option.children) {\n        return this.partialChecked(option.children);\n      }\n      return this.props.selectedOptions.some(\n        selectedOption => selectedOption.value == option.value\n      );\n    });\n  }\n\n  reload() {\n    const reload = this.props.reloadOptions;\n    reload && reload();\n  }\n\n  renderOptions(\n    newOptions: Array<any>,\n    isChildren: boolean,\n    uncheckable: boolean\n  ): any {\n    const {\n      multiple,\n      selectedOptions,\n      classnames: cx,\n      value,\n      options,\n      disabled,\n      cascade\n    } = this.props;\n\n    if (multiple) {\n      let partialChecked = this.partialChecked(options);\n      let allChecked = this.allChecked(options);\n\n      return (\n        <div className={cx({'NestedSelect-childrenOuter': isChildren})}>\n          {!isChildren ? (\n            <div className={cx('NestedSelect-option', 'checkall')}>\n              <Checkbox\n                onChange={this.handleCheck.bind(this, options)}\n                checked={partialChecked}\n                partial={partialChecked && !allChecked}\n              >\n                全选\n              </Checkbox>\n            </div>\n          ) : null}\n          {newOptions.map((option, idx) => {\n            const checked = selectedOptions.some(o => o.value == option.value);\n            const selfChecked = !!uncheckable || checked;\n            let nodeDisabled = !!uncheckable || !!disabled;\n\n            return (\n              <div className={cx('NestedSelect-option')} key={idx}>\n                <Checkbox\n                  onChange={this.handleCheck.bind(this, option)}\n                  trueValue={option.value}\n                  checked={selfChecked}\n                  disabled={nodeDisabled}\n                >\n                  {option.label}\n                </Checkbox>\n                {option.children ? (\n                  <div className={cx('NestedSelect-optionArrowRight')}>\n                    <Icon icon=\"right-arrow\" className=\"icon\" />\n                  </div>\n                ) : null}\n                {option.children && option.children.length\n                  ? this.renderOptions(\n                      option.children,\n                      true,\n                      cascade ? false : uncheckable || (multiple && checked)\n                    )\n                  : null}\n              </div>\n            );\n          })}\n        </div>\n      );\n    }\n\n    return (\n      <div className={cx({'NestedSelect-childrenOuter': isChildren})}>\n        {newOptions.map((option, idx) => (\n          <div\n            key={idx}\n            className={cx('NestedSelect-option', {\n              'is-active': value && value === option.value\n            })}\n            onClick={this.handleOptionClick.bind(this, option)}\n          >\n            <span>{option.label}</span>\n            {option.children ? (\n              <div className={cx('NestedSelect-optionArrowRight')}>\n                <Icon icon=\"right-arrow\" className=\"icon\" />\n              </div>\n            ) : null}\n            {option.children && option.children.length\n              ? this.renderOptions(option.children, true, false)\n              : null}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  renderOuter() {\n    const {popOverContainer, options, classnames: cx} = this.props;\n\n    let body = (\n      <RootCloseWrapper\n        disabled={!this.state.isOpened}\n        onRootClose={this.close}\n      >\n        <div\n          className={cx('NestedSelect-menuOuter')}\n          style={{minWidth: this.target.offsetWidth}}\n        >\n          {this.renderOptions(options, false, false)}\n        </div>\n      </RootCloseWrapper>\n    );\n\n    if (popOverContainer) {\n      return (\n        <Overlay container={popOverContainer} target={() => this.target} show>\n          <PopOver\n            className={cx('NestedSelect-popover')}\n            style={{minWidth: this.target.offsetWidth}}\n          >\n            {body}\n          </PopOver>\n        </Overlay>\n      );\n    }\n    return body;\n  }\n\n  render() {\n    const {\n      className,\n      disabled,\n      placeholder,\n      selectedOptions,\n      classnames: cx\n    } = this.props;\n\n    return (\n      <div className={cx('NestedSelectControl')}>\n        <div\n          className={cx(\n            'NestedSelect',\n            {\n              'is-opened': this.state.isOpened,\n              'is-disabled': disabled\n            },\n            className\n          )}\n          onClick={this.open}\n          ref={this.domRef}\n        >\n          {!(selectedOptions && selectedOptions.length > 0) ? (\n            <div className={cx('NestedSelect-placeholder')}>{placeholder}</div>\n          ) : null}\n\n          {this.renderValue()}\n          {this.renderClear()}\n\n          <span className={cx('Select-arrow')} />\n        </div>\n\n        {this.state.isOpened ? this.renderOuter() : null}\n      </div>\n    );\n  }\n}\n\n@OptionsControl({\n  type: 'nested-select'\n})\nexport class NestedSelectControlRenderer extends NestedSelectControl {}\n"
    ]
}