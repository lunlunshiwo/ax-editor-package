{
    "version": 3,
    "file": "tpl-builtin.js",
    "sourceRoot": "",
    "sources": [
        "/src/utils/tpl-builtin.ts"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import {reigsterTplEnginer, filter} from './tpl';\nimport moment from 'moment';\nimport {PlainObject} from '../types';\nimport isPlainObject = require('lodash/isPlainObject');\nimport {createObject, isObject, setVariable, qsstringify} from './helper';\n\nconst UNITS = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n\nexport const prettyBytes = (num: number) => {\n  if (!Number.isFinite(num)) {\n    throw new TypeError(`Expected a finite number, got ${typeof num}: ${num}`);\n  }\n\n  const neg = num < 0;\n\n  if (neg) {\n    num = -num;\n  }\n\n  if (num < 1) {\n    return (neg ? '-' : '') + num + ' B';\n  }\n\n  const exponent = Math.min(\n    Math.floor(Math.log(num) / Math.log(1000)),\n    UNITS.length - 1\n  );\n  const numStr = Number((num / Math.pow(1000, exponent)).toPrecision(3));\n  const unit = UNITS[exponent];\n\n  return (neg ? '-' : '') + numStr + ' ' + unit;\n};\n\nconst entityMap: {\n  [propName: string]: string;\n} = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;'\n};\nexport const escapeHtml = (str: string) =>\n  String(str).replace(/[&<>\"'\\/]/g, function(s) {\n    return entityMap[s];\n  });\n\nexport function formatDuration(value: number): string {\n  const unit = ['秒', '分', '时', '天', '月', '季', '年'];\n  const steps = [1, 60, 3600, 86400, 2592000, 7776000, 31104000];\n  let len = steps.length;\n  const parts = [];\n\n  while (len--) {\n    if (steps[len] && value >= steps[len]) {\n      parts.push(Math.round(value / steps[len]) + unit[len]);\n      value %= steps[len];\n    } else if (len === 0 && value) {\n      parts.push((value.toFixed ? value.toFixed(2) : '0') + unit[0]);\n    }\n  }\n\n  return parts.join('');\n}\n\nconst timeUnitMap: {\n  [propName: string]: string;\n} = {\n  year: 'Y',\n  years: 'Y',\n  month: 'M',\n  months: 'M',\n  week: 'w',\n  weeks: 'w',\n  weekday: 'W',\n  day: 'd',\n  days: 'd',\n  hour: 'h',\n  hours: 'h',\n  minute: 'm',\n  minutes: 'm',\n  min: 'm',\n  mins: 'm'\n};\n\nexport const relativeValueRe = /^(.+)?(\\+|-)(\\d+)(minute|minutes|min|mins|hours|hour|day|days|week|weeks|month|months|year|years|weekday)$/i;\nexport const filterDate = (\n  value: string,\n  data: object = {},\n  format = 'X'\n): moment.Moment => {\n  let m;\n\n  if (typeof value === 'string') {\n    value = value.trim();\n  }\n\n  value = filter(value, data);\n\n  if (value && typeof value === 'string' && (m = relativeValueRe.exec(value))) {\n    const date = new Date();\n    const step = parseInt(m[3], 10);\n    const from = m[1]\n      ? filterDate(m[1], data, format)\n      : moment(\n          /minute|minutes|min|mins|hours|hour/.test(m[4])\n            ? [\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDate(),\n                date.getHours(),\n                date.getMinutes(),\n                date.getSeconds()\n              ]\n            : [date.getFullYear(), date.getMonth(), date.getDate()]\n        );\n\n    return m[2] === '-'\n      ? from.subtract(step, timeUnitMap[m[4]] as moment.DurationInputArg2)\n      : from.add(step, timeUnitMap[m[4]] as moment.DurationInputArg2);\n    //   return from[m[2] === '-' ? 'subtract' : 'add'](step, mapping[m[4]] || m[4]);\n  } else if (value === 'now') {\n    return moment();\n  } else if (value === 'today') {\n    const date = new Date();\n    return moment([date.getFullYear(), date.getMonth(), date.getDate()]);\n  } else {\n    return moment(value, format);\n  }\n};\n\nexport const filters: {\n  [propName: string]: (input: any, ...args: any[]) => any;\n} = {\n  html: (input: string) => escapeHtml(input),\n  json: (input, tabSize: number | string = 2) =>\n    tabSize\n      ? JSON.stringify(input, null, parseInt(tabSize as string, 10))\n      : JSON.stringify(input),\n  toJson: input => {\n    let ret;\n    try {\n      ret = JSON.parse(input);\n    } catch (e) {\n      ret = null;\n    }\n    return ret;\n  },\n  raw: input => input,\n  date: (input, format = 'LLL', inputFormat = 'X') =>\n    moment(input, inputFormat).format(format),\n  number: input => {\n    let parts = String(input).split('.');\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n    return parts.join('.');\n  },\n  trim: input => input.trim(),\n  percent: (input, decimals = 0) => {\n    input = parseFloat(input) || 0;\n    decimals = parseInt(decimals, 10) || 0;\n\n    let whole = input * 100;\n    let multiplier = Math.pow(10, decimals);\n\n    return (\n      (Math.round(whole * multiplier) / multiplier).toFixed(decimals) + '%'\n    );\n  },\n  duration: input => (input ? formatDuration(input) : input),\n  bytes: input => (input ? prettyBytes(parseFloat(input)) : input),\n  round: (input, decimals = 0) => {\n    if (isNaN(input)) {\n      return 0;\n    }\n\n    decimals = parseInt(decimals, 10) || 2;\n\n    let multiplier = Math.pow(10, decimals);\n    return (Math.round(input * multiplier) / multiplier).toFixed(decimals);\n  },\n  truncate: (input, length, end) => {\n    end = end || '...';\n\n    if (length == null) {\n      return input;\n    }\n\n    length = parseInt(length, 10) || 200;\n\n    return input.substring(0, length) + (input.length > length ? end : '');\n  },\n  url_encode: input => encodeURIComponent(input),\n  url_decode: input => decodeURIComponent(input),\n  default: (input, defaultValue) =>\n    input ||\n    (() => {\n      try {\n        if (defaultValue === 'undefined') {\n          return undefined;\n        }\n\n        return JSON.parse(defaultValue);\n      } catch (e) {\n        return defaultValue;\n      }\n    })(),\n  join: (input, glue) => (input && input.join ? input.join(glue) : input),\n  split: (input, delimiter = ',') =>\n    typeof input === 'string' ? input.split(delimiter) : input,\n  first: input => input && input[0],\n  nth: (input, nth = 0) => input && input[nth],\n  last: input => input && (input.length ? input[input.length - 1] : null),\n  minus: (input, step = 1) => (parseInt(input, 10) || 0) - parseInt(step, 10),\n  plus: (input, step = 1) => (parseInt(input, 10) || 0) + parseInt(step, 10),\n  pick: (input, path = '&') =>\n    Array.isArray(input) && !/^\\d+$/.test(path)\n      ? input.map(item => pickValues(path, item))\n      : pickValues(path, input),\n  pick_if_exist: (input, path = '&') =>\n    Array.isArray(input)\n      ? input.map(item => resolveVariable(path, item) || item)\n      : resolveVariable(path, input) || input,\n  str2date: function(input, inputFormat = 'X', outputFormat = 'X') {\n    return input\n      ? filterDate(input, this, inputFormat).format(outputFormat)\n      : '';\n  },\n  asArray: input => (input ? [input] : input),\n  filter: function(input, keys, expOrDirective, arg1) {\n    if (!Array.isArray(input) || !keys || !expOrDirective) {\n      return input;\n    }\n\n    let directive = expOrDirective;\n    let fn: (value: any, key: string, item: any) => boolean = () => true;\n\n    if (directive === 'isTrue') {\n      fn = value => !!value;\n    } else if (directive === 'isFalse') {\n      fn = value => !value;\n    } else if (directive === 'isExists') {\n      fn = value => typeof value !== 'undefined';\n    } else {\n      if (directive !== 'match') {\n        directive = 'match';\n        arg1 = expOrDirective;\n      }\n      arg1 = arg1\n        ? /^('|\")(.*)\\1$/.test(arg1)\n          ? RegExp.$2\n          : resolveVariable(arg1, this as any)\n        : '';\n\n      // 比对的值是空时直接返回。\n      if (!arg1) {\n        return input;\n      }\n\n      fn = value =>\n        !!~String(value)\n          .toLowerCase()\n          .indexOf(arg1);\n    }\n\n    keys = keys.split(/\\s*,\\s*/);\n    return input.filter((item: any) =>\n      keys.some((key: string) => fn(resolveVariable(key, item), key, item))\n    );\n  },\n  base64Encode(str) {\n    return btoa(\n      encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function toSolidBytes(\n        match,\n        p1\n      ) {\n        return String.fromCharCode(('0x' + p1) as any);\n      })\n    );\n  },\n\n  base64Decode(str) {\n    return decodeURIComponent(\n      atob(str)\n        .split('')\n        .map(function(c) {\n          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        })\n        .join('')\n    );\n  },\n\n  lowerCase: input =>\n    input && typeof input === 'string' ? input.toLowerCase() : input,\n  upperCase: input =>\n    input && typeof input === 'string' ? input.toUpperCase() : input\n};\n\nexport function registerFilter(\n  name: string,\n  fn: (input: any, ...args: any[]) => any\n): void {\n  filters[name] = fn;\n}\n\nexport function pickValues(names: string, data: object) {\n  let arr: Array<string>;\n  if (!names || ((arr = names.split(',')) && arr.length < 2)) {\n    let idx = names.indexOf('~');\n    if (~idx) {\n      let key = names.substring(0, idx);\n      let target = names.substring(idx + 1);\n      return {\n        [key]: resolveVariable(target, data)\n      };\n    }\n    return resolveVariable(names, data);\n  }\n\n  let ret: any = {};\n  arr.forEach(name => {\n    let idx = name.indexOf('~');\n    let target = name;\n\n    if (~idx) {\n      target = name.substring(idx + 1);\n      name = name.substring(0, idx);\n    }\n\n    setVariable(ret, name, resolveVariable(target, data));\n  });\n  return ret;\n}\n\nexport const resolveVariable = (path: string, data: any = {}): any => {\n  if (!path) {\n    return undefined;\n  }\n\n  if (path === '$$') {\n    return data;\n  } else if (path[0] === '$') {\n    path = path.substring(1);\n  } else if (path === '&') {\n    return data;\n  }\n\n  if (typeof data[path] !== 'undefined') {\n    return data[path];\n  }\n\n  let parts = path.replace(/^{|}$/g, '').split('.');\n  return parts.reduce((data, path) => {\n    if ((isObject(data) || Array.isArray(data)) && path in data) {\n      return (data as {[propName: string]: any})[path];\n    }\n\n    return undefined;\n  }, data);\n};\n\nexport const resolveVariableAndFilter = (\n  path: string,\n  data: object = {},\n  defaultFilter: string = '| html'\n): any => {\n  if (!path) {\n    return undefined;\n  }\n\n  const m = /^(\\\\)?\\$(?:([a-z0-9_.]+)|{([\\s\\S]+)})$/i.exec(path);\n\n  if (!m) {\n    return undefined;\n  }\n\n  const [_, escape, key, key2] = m;\n\n  // 如果是转义如： `\\$abc` => `$abc`\n  if (escape) {\n    return _.substring(1);\n  }\n\n  let finalKey: string = key || key2;\n\n  // 先只支持一层吧\n  finalKey = finalKey.replace(\n    /(\\\\)?\\$(?:([a-z0-9_.]+)|{([^}{]+)})/g,\n    (_, escape) => {\n      return escape\n        ? _.substring(1)\n        : resolveVariableAndFilter(_, data, defaultFilter);\n    }\n  );\n\n  // 默认 html 转义\n  if (!~finalKey.indexOf('|')) {\n    finalKey += defaultFilter;\n  }\n\n  let paths = finalKey.split(/\\s*\\|\\s*/g);\n  let originalKey = finalKey;\n  finalKey = paths.shift() as string;\n\n  let ret = resolveVariable(finalKey, data);\n\n  return ret == null && !~originalKey.indexOf('default')\n    ? ''\n    : paths.reduce((input, filter) => {\n        let params = filter\n          .replace(\n            /([^\\\\])\\\\([\\:\\\\])/g,\n            (_, affix, content) =>\n              `${affix}__${content === ':' ? 'colon' : 'slash'}__`\n          )\n          .split(':')\n          .map(item =>\n            item.replace(/__(slash|colon)__/g, (_, type) =>\n              type === 'colon' ? ':' : '\\\\'\n            )\n          );\n        let key = params.shift() as string;\n\n        return (filters[key] || filters.raw).call(data, input, ...params);\n      }, ret);\n};\n\nexport const tokenize = (\n  str: string,\n  data: object,\n  defaultFilter: string = '| html'\n) => {\n  if (!str || typeof str !== 'string') {\n    return str;\n  }\n\n  return str.replace(\n    /(\\\\)?\\$(?:([a-z0-9_\\.]+|&|\\$)|{([^}{]+?)})/gi,\n    (_, escape, key1, key2, index, source) => {\n      if (!escape && key1 === '$') {\n        const prefix = source[index - 1];\n        return prefix === '='\n          ? encodeURIComponent(JSON.stringify(data))\n          : qsstringify(data);\n      }\n\n      return escape\n        ? _.substring(1)\n        : resolveVariableAndFilter(_, data, defaultFilter);\n    }\n  );\n};\n\nfunction resolveMapping(value: any, data: PlainObject) {\n  return typeof value === 'string' &&\n    /^\\$(?:([a-z0-9_.]+)|{[^}{]+})$/.test(value)\n    ? resolveVariableAndFilter(value, data, '| raw')\n    : typeof value === 'string' && ~value.indexOf('$')\n    ? tokenize(value, data, '| raw')\n    : value;\n}\n\nexport function dataMapping(to: any, from: PlainObject): any {\n  let ret = {};\n\n  if (Array.isArray(to)) {\n    return to.map(item => dataMapping(item, from));\n  } else if (!to) {\n    return ret;\n  }\n\n  Object.keys(to).forEach(key => {\n    const value = to[key];\n    let keys: Array<string>;\n\n    if (key === '&' && value === '$$') {\n      ret = {\n        ...ret,\n        ...from\n      };\n    } else if (key === '&') {\n      const v =\n        isPlainObject(value) &&\n        (keys = Object.keys(value)) &&\n        keys.length === 1 &&\n        from[keys[0].substring(1)] &&\n        Array.isArray(from[keys[0].substring(1)])\n          ? from[keys[0].substring(1)].map((raw: object) =>\n              dataMapping(value[keys[0]], createObject(from, raw))\n            )\n          : resolveMapping(value, from);\n\n      if (Array.isArray(v) || typeof v === 'string') {\n        ret = v;\n      } else if (typeof v === 'function') {\n        ret = {\n          ...ret,\n          ...v(from)\n        };\n      } else {\n        ret = {\n          ...ret,\n          ...v\n        };\n      }\n    } else if (value === '$$') {\n      (ret as PlainObject)[key] = from;\n    } else if (value && value[0] === '$') {\n      const v = resolveMapping(value, from);\n      (ret as PlainObject)[key] = v;\n\n      if (v === '__undefined') {\n        delete (ret as PlainObject)[key];\n      }\n    } else if (\n      isPlainObject(value) &&\n      (keys = Object.keys(value)) &&\n      keys.length === 1 &&\n      from[keys[0].substring(1)] &&\n      Array.isArray(from[keys[0].substring(1)])\n    ) {\n      // 支持只取数组中的部分值这个需求\n      // 如:\n      // data: {\n      //   items: {\n      //     '$rows': {\n      //        id: '$id',\n      //        forum_id: '$forum_id'\n      //      }\n      //   }\n      // }\n      const arr = from[keys[0].substring(1)];\n      const mapping = value[keys[0]];\n\n      (ret as PlainObject)[key] = arr.map((raw: object) =>\n        dataMapping(mapping, createObject(from, raw))\n      );\n    } else if (isPlainObject(value)) {\n      (ret as PlainObject)[key] = dataMapping(value, from);\n    } else if (Array.isArray(value)) {\n      (ret as PlainObject)[key] = value.map((value: any) =>\n        isPlainObject(value)\n          ? dataMapping(value, from)\n          : resolveMapping(value, from)\n      );\n    } else if (typeof value == 'string' && ~value.indexOf('$')) {\n      (ret as PlainObject)[key] = resolveMapping(value, from);\n    } else if (typeof value === 'function') {\n      (ret as PlainObject)[key] = value(from);\n    } else {\n      (ret as PlainObject)[key] = value;\n\n      if (value === '__undefined') {\n        delete (ret as PlainObject)[key];\n      }\n    }\n  });\n\n  return ret;\n}\n\nreigsterTplEnginer('builtin', {\n  test: str => !!~str.indexOf('$'),\n  compile: (str: string, data: object, defaultFilter = '| html') =>\n    tokenize(str, data, defaultFilter)\n});\n"
    ]
}